var Dt=Object.defineProperty,Et=Object.defineProperties;var $t=Object.getOwnPropertyDescriptors;var Ye=Object.getOwnPropertySymbols;var qt=Object.prototype.hasOwnProperty,Ot=Object.prototype.propertyIsEnumerable;var _e=(e,t,o)=>t in e?Dt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,O=(e,t)=>{for(var o in t||(t={}))qt.call(t,o)&&_e(e,o,t[o]);if(Ye)for(var o of Ye(t))Ot.call(t,o)&&_e(e,o,t[o]);return e},z=(e,t)=>Et(e,$t(t));var y=(e,t,o)=>(_e(e,typeof t!="symbol"?t+"":t,o),o);import{P as Lt,R as Ht,E as B,S as Be,q as R,a as j,C as D,T as Nt,o as _,b as I,p as C,U as ue,t as G,x as Y,I as ve,V as F,F as Z,v as ce,J as ee,W as Rt,e as M,l as jt,r as te,X as Ue,Y as Wt,w as P,Z as Pt,_ as At,$ as zt,G as U,a0 as ge,a1 as Ft,a2 as Vt,a3 as J,a4 as E,a5 as H,a6 as oe,a7 as Me,a8 as Kt,a9 as Ce,aa as Qt,ab as V,ac as de,ad as Ie,ae as Je,af as Yt,ag as Ut,ah as Xe,ai as Jt,aj as Ge,ak as K,al as Ze,am as Se,an as Xt,ao as De,ap as et,aq as Gt,ar as Zt,as as eo,at as to,au as oo,av as no,aw as ao,ax as io,ay as lo,az as so,aA as ro,aB as uo,aC as co,aD as tt,aE as mo,aF as ko,aG as vo,aH as go,aI as fo,aJ as ho,aK as po,aL as bo,aM as Ee,aN as yo,aO as wo,aP as To,aQ as xo,aR as _o,aS as Bo,H as Mo,aT as Co,B as Io}from"./vendor.d57eb1e4.js";import{u as Q,t as So}from"./date.6ac30a44.js";import{c as L,d as $e}from"./index.cee9a179.js";import{_ as Do}from"./plugin-vue_export-helper.21dcd24c.js";import{C as Eo}from"./circle-spinner.13cd4e61.js";let $o=e=>crypto.getRandomValues(new Uint8Array(e)),qo=(e,t,o)=>{let n=(2<<Math.log(e.length-1)/Math.LN2)-1,a=-~(1.6*n*t/e.length);return(l=t)=>{let i="";for(;;){let r=o(a),c=a;for(;c--;)if(i+=e[r[c]&n]||"",i.length===l)return i}}},Oo=(e,t=21)=>qo(e,t,$o);var Lo=["2g1c","2 girls 1 cup","acrotomophilia","alabama hot pocket","alaskan pipeline","anal","anilingus","anus","apeshit","arsehole","ass","asshole","assmunch","auto erotic","autoerotic","babeland","baby batter","baby juice","ball gag","ball gravy","ball kicking","ball licking","ball sack","ball sucking","bangbros","bangbus","bareback","barely legal","barenaked","bastard","bastardo","bastinado","bbw","bdsm","beaner","beaners","beaver cleaver","beaver lips","beastiality","bestiality","big black","big breasts","big knockers","big tits","bimbos","birdlock","bitch","bitches","black cock","blonde action","blonde on blonde action","blowjob","blow job","blow your load","blue waffle","blumpkin","bollocks","bondage","boner","boob","boobs","booty call","brown showers","brunette action","bukkake","bulldyke","bullet vibe","bullshit","bung hole","bunghole","busty","butt","buttcheeks","butthole","camel toe","camgirl","camslut","camwhore","carpet muncher","carpetmuncher","chocolate rosebuds","cialis","circlejerk","cleveland steamer","clit","clitoris","clover clamps","clusterfuck","cock","cocks","coprolagnia","coprophilia","cornhole","coon","coons","creampie","cum","cumming","cumshot","cumshots","cunnilingus","cunt","darkie","date rape","daterape","deep throat","deepthroat","dendrophilia","dick","dildo","dingleberry","dingleberries","dirty pillows","dirty sanchez","doggie style","doggiestyle","doggy style","doggystyle","dog style","dolcett","domination","dominatrix","dommes","donkey punch","double dong","double penetration","dp action","dry hump","dvda","eat my ass","ecchi","ejaculation","erotic","erotism","escort","eunuch","fag","faggot","fecal","felch","fellatio","feltch","female squirting","femdom","figging","fingerbang","fingering","fisting","foot fetish","footjob","frotting","fuck","fuck buttons","fuckin","fucking","fucktards","fudge packer","fudgepacker","futanari","gangbang","gang bang","gay sex","genitals","giant cock","girl on","girl on top","girls gone wild","goatcx","goatse","god damn","gokkun","golden shower","goodpoop","goo girl","goregasm","grope","group sex","g-spot","guro","hand job","handjob","hard core","hardcore","hentai","homoerotic","honkey","hooker","horny","hot carl","hot chick","how to kill","how to murder","huge fat","humping","incest","intercourse","jack off","jail bait","jailbait","jelly donut","jerk off","jigaboo","jiggaboo","jiggerboo","jizz","juggs","kike","kinbaku","kinkster","kinky","knobbing","leather restraint","leather straight jacket","lemon party","livesex","lolita","lovemaking","make me come","male squirting","masturbate","masturbating","masturbation","menage a trois","milf","missionary position","mong","motherfucker","mound of venus","mr hands","muff diver","muffdiving","nambla","nawashi","negro","neonazi","nigga","nigger","nig nog","nimphomania","nipple","nipples","nsfw","nsfw images","nude","nudity","nutten","nympho","nymphomania","octopussy","omorashi","one cup two girls","one guy one jar","orgasm","orgy","paedophile","paki","panties","panty","pedobear","pedophile","pegging","penis","phone sex","piece of shit","pikey","pissing","piss pig","pisspig","playboy","pleasure chest","pole smoker","ponyplay","poof","poon","poontang","punany","poop chute","poopchute","porn","porno","pornography","prince albert piercing","pthc","pubes","pussy","queaf","queef","quim","raghead","raging boner","rape","raping","rapist","rectum","reverse cowgirl","rimjob","rimming","rosy palm","rosy palm and her 5 sisters","rusty trombone","sadism","santorum","scat","schlong","scissoring","semen","sex","sexcam","sexo","sexy","sexual","sexually","sexuality","shaved beaver","shaved pussy","shemale","shibari","shit","shitblimp","shitty","shota","shrimping","skeet","slanteye","slut","s&m","smut","snatch","snowballing","sodomize","sodomy","spastic","spic","splooge","splooge moose","spooge","spread legs","spunk","strap on","strapon","strappado","strip club","style doggy","suck","sucks","suicide girls","sultry women","swastika","swinger","tainted love","taste my","tea bagging","threesome","throating","thumbzilla","tied up","tight white","tit","tits","titties","titty","tongue in a","topless","tosser","towelhead","tranny","tribadism","tub girl","tubgirl","tushy","twat","twink","twinkie","two girls one cup","undressing","upskirt","urethra play","urophilia","vagina","venus mound","viagra","vibrator","violet wand","vorarephilia","voyeur","voyeurweb","voyuer","vulva","wank","wetback","wet dream","white power","whore","worldsex","wrapping men","wrinkled starfish","xx","xxx","yaoi","yellow showers","yiffy","zoophilia","\u{1F595}"];function Ho(e){const t=e.replace(/1/g,"i").replace(/3/g,"e").replace(/5/g,"s").replace(/8/g,"b").replace(/0/g,"o");for(const o of Lo){const n=o.replace(/ /g,"").replace("l","i");if(new RegExp(n,"gi").test(t))return!0}return!1}function No(e){const t=e("6789BCDFGHJKLMNPQRTWbcdfghjkmnpqrtwz");return function(o=30){let n=t(o);for(;Ho(n);)n=t(o);return n}}const ne=No(Oo),We=class{constructor({id:t,name:o,description:n,color:a,isHidden:l}){y(this,"type");y(this,"id");y(this,"name");y(this,"color");y(this,"description");y(this,"isHidden");this.id=t,this.setName(o),this.setColor(a!=null?a:We.color),n!==void 0&&this.setDescription(n),this.type="normal",this.setIsHidden(l)}setName(t){this.name=t}getType(){return this.type}getName(){return this.name}getId(){return this.id}getColor(){return this.color}setColor(t){this.color=t}getIsHidden(){return this.isHidden}setIsHidden(t){this.isHidden=t}getDescription(){return this.description}setDescription(t){this.description=t}removeDescription(){this.description=void 0}};let ae=We;y(ae,"color","#ffcccc");const Pe=class extends ae{constructor(t){super(t);y(this,"startMinute");y(this,"endMinute");this.setColor(Pe.color),this.type="fixed-time",this.setStartMinute(t.startMinute),this.setEndMinute(t.endMinute)}getStartMinute(){return this.startMinute}setStartMinute(t){this.startMinute=t}getEndMinute(){return this.endMinute}setEndMinute(t){this.endMinute=t}};let ie=Pe;y(ie,"color","#ffd9b3");const Ae=class extends ie{constructor(t){super(t);y(this,"dayOfWeek");this.setColor(Ae.color),this.type="fixed-weekly-time",this.setDayOfWeek(t.dayOfWeek)}setDayOfWeek(t){if(t!==void 0&&(t<0||t>6))throw new Error("Day of week must be between 0 and 6 inclusive.");this.dayOfWeek=t}getDayOfWeek(){return this.dayOfWeek}};let le=Ae;y(le,"color","#e6ffe6");function Ro({taskBlocks:e}){const t=[];for(const o of e){const n=o.getStartMinute(),a=o.getEndMinute();t.push(a-n)}return t}function jo(e){return Lt()?(Ht(e),!0):!1}const me=typeof window!="undefined",Wo=e=>typeof e=="string",qe=()=>{},ot=me?window:void 0;me&&window.document;me&&window.navigator;me&&window.location;function ke(...e){let t,o,n,a;if(Wo(e[0])?([o,n,a]=e,t=ot):[t,o,n,a]=e,!t)return qe;let l=qe;const i=Be(()=>R(t),c=>{l(),!!c&&(c.addEventListener(o,n,a),l=()=>{c.removeEventListener(o,n,a),l=qe})},{immediate:!0,flush:"post"}),r=()=>{i(),l()};return jo(r),r}const Oe=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},Le="__vueuse_ssr_handlers__";Oe[Le]=Oe[Le]||{};Oe[Le];function Po(e={}){const{type:t="page",touch:o=!0,resetOnTouchEnds:n=!1,initialValue:a={x:0,y:0},window:l=ot}=e,i=B(a.x),r=B(a.y),c=B(null),d=k=>{t==="page"?(i.value=k.pageX,r.value=k.pageY):t==="client"&&(i.value=k.clientX,r.value=k.clientY),c.value="mouse"},m=()=>{i.value=a.x,r.value=a.y},f=k=>{if(k.touches.length>0){const s=k.touches[0];t==="page"?(i.value=s.pageX,r.value=s.pageY):t==="client"&&(i.value=s.clientX,r.value=s.clientY),c.value="touch"}};return l&&(ke(l,"mousemove",d,{passive:!0}),ke(l,"dragover",d,{passive:!0}),o&&(ke(l,"touchstart",f,{passive:!0}),ke(l,"touchmove",f,{passive:!0}),n&&ke(l,"touchend",m,{passive:!0}))),{x:i,y:r,sourceType:c}}var nt,at;me&&(window==null?void 0:window.navigator)&&((nt=window==null?void 0:window.navigator)==null?void 0:nt.platform)&&/iP(ad|hone|od)/.test((at=window==null?void 0:window.navigator)==null?void 0:at.platform);var Ao=Object.defineProperty,it=Object.getOwnPropertySymbols,zo=Object.prototype.hasOwnProperty,Fo=Object.prototype.propertyIsEnumerable,lt=(e,t,o)=>t in e?Ao(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,Vo=(e,t)=>{for(var o in t||(t={}))zo.call(t,o)&&lt(e,o,t[o]);if(it)for(var o of it(t))Fo.call(t,o)&&lt(e,o,t[o]);return e};const Ko={top:0,left:0,bottom:0,right:0,height:0,width:0};Vo({text:""},Ko);var se;(function(e){e.taskBoxDrop="task-box-drop"})(se||(se={}));function fe(e){return Math.round(e/15)*15}const Qo=["onMousedown"],Yo={key:0,class:"text-sm text-gray-500"},Uo=["onMousedown"],Jo=j({props:{timeblockColumnId:null,taskBlockId:null,heightRatio:null},setup(e){const t=e;let o=B({});const n=Q(),a=D(()=>n.activeTimeblock.getTaskBlock(t.taskBlockId)),l=D(()=>a.value.getTask()),i=D(()=>({"grid-column":"1 / span 1","grid-row-start":1+a.value.getStartMinute(),"grid-row-end":1+a.value.getEndMinute(),"background-color":a.value.getTask().getColor()}));let r=B(!1),c=B(void 0),d=B(!1),m=B(void 0);function f(x){var S;if(r.value||d.value){x.preventDefault();return}n.activeDraggingTaskBlock={id:t.taskBlockId,initialMouseY:x.pageY},(S=x.dataTransfer)==null||S.setData("text",JSON.stringify({type:se.taskBoxDrop,payload:{sourceTaskBlockId:t.taskBlockId}}))}function k(){n.activeDraggingTaskBlock=void 0}const s=B(),p=Po(),v=Nt(p,"y");function h(x){r.value=!0,c.value=x.pageY}window.addEventListener("mouseup",async()=>{if(!r.value)return;r.value=!1;const x=g();n.activeTimeblock.getTaskBlock(t.taskBlockId).setStartMinute(x),await L.mutation("updateTimeblockTaskBlock",{timeblockColumnId:t.timeblockColumnId,taskBlockId:t.taskBlockId,startMinute:x}),c.value=void 0,o.value={}});function u(x){d.value=!0,m.value=x.pageY}window.addEventListener("mouseup",async()=>{if(!d.value)return;d.value=!1;const x=w();n.activeTimeblock.getTaskBlock(t.taskBlockId).setEndMinute(x),await L.mutation("updateTimeblockTaskBlock",{timeblockColumnId:t.timeblockColumnId,taskBlockId:t.taskBlockId,endMinute:x}),m.value=void 0,o.value={}});function g(){return c.value===void 0?a.value.getStartMinute():Math.min(a.value.getEndMinute()-16,fe(a.value.getStartMinute()+(v.value-c.value)))}function w(){return m.value===void 0?a.value.getEndMinute():Math.max(a.value.getStartMinute()+16,fe(a.value.getEndMinute()+(v.value-m.value)))}Be(()=>[r.value,d.value,v.value],()=>{r.value&&c.value!==void 0?o.value={"grid-row-start":1+g()}:d.value&&m.value!==void 0&&(o.value={"grid-row-end":1+w()})});const T=D(()=>r.value?w()-g()>30:a.value.getEndMinute()-a.value.getStartMinute()>30);return(x,S)=>(_(),I("div",{ref_key:"taskBlockEl",ref:s,draggable:"true",class:"column center relative cursor-grab rounded-md active:cursor-grabbing",style:F([i.value,o.value]),onDragstart:f,onDragend:k},[C("div",{class:"absolute inset-x-0 top-0 h-[4px] cursor-ns-resize",onMousedown:ue(h,["stop"])},null,40,Qo),G(" "+Y(l.value.getName())+" ",1),T.value?(_(),I("div",Yo,Y(l.value.getDescription()),1)):ve("",!0),C("div",{class:"absolute inset-x-0 bottom-0 h-[4px] cursor-ns-resize",onMousedown:ue(u,["stop"])},null,40,Uo)],36))}}),Xo=j({props:{startDayMinute:null,endDayMinute:null},setup(e){const t=e,o=D(()=>({"grid-row-start":1+t.startDayMinute,"grid-row-end":1+t.endDayMinute,"grid-column":"1 / span 1"}));return(n,a)=>(_(),I("div",{style:F(o.value),class:"-z-1 h-full w-full border-x border-t border-gray-200"},null,4))}}),Go=j({setup(e){const t=D(()=>({display:"grid","grid-template-rows":"repeat(1440, 1px)","grid-template-columns":"1fr"})),o=Array.from({length:24}).map((n,a)=>a*60);return(n,a)=>(_(),I("div",{style:F(t.value),class:"border-b border-gray-200"},[(_(!0),I(Z,null,ce(R(o),l=>(_(),ee(Xo,{key:l,"start-day-minute":l,"end-day-minute":l+60},null,8,["start-day-minute","end-day-minute"]))),128))],4))}});class He{constructor({id:t,task:o,startMinute:n,endMinute:a,timeblock:l,timeblockColumnId:i}){y(this,"type");y(this,"task");y(this,"id");y(this,"startMinute");y(this,"endMinute");y(this,"timeblock");y(this,"timeblockColumnId");this.id=t,this.timeblock=l,this.task=o,this.type="normal",this.setStartMinute(n),this.setEndMinute(a),this.setTimeblockColumnId(i)}getId(){return this.id}getTask(){return this.task}setTask(t){this.task=t}getStartMinute(){return this.startMinute}setStartMinute(t){if(t===void 0)throw new Error("startMinute cannot be undefined.");if(t<0||t>1440)throw new Error(`Minute must be between 0 and 1440, received ${t}`);this.startMinute=t}getEndMinute(){return this.endMinute}setEndMinute(t){if(t===void 0)throw new Error("endMinute cannot be undefined.");if(t<0||t>1440)throw new Error(`Minute must be between 0 and 1440, received ${t}`);this.endMinute=t}getTimeblockColumnId(){return this.timeblockColumnId}setTimeblockColumnId(t){this.timeblockColumnId=t}getType(){return this.type}}class Ne extends He{constructor(t){super(t);y(this,"task");this.task=t.task}getTask(){return this.task}setTask(t){this.task=t}getStartMinute(){return this.getTask().getStartMinute()}setStartMinute(t){this.getTask().setStartMinute(t)}getEndMinute(){return this.getTask().getEndMinute()}setEndMinute(t){this.getTask().setEndMinute(t)}}class st extends Ne{constructor(t){super(t);y(this,"task");this.task=t.task}getTask(){return this.task}setTask(t){this.task=t}}const Zo=["onDragover","onDragleave"],en=j({props:{timeblockColumnId:null,date:null},setup(e){const t=e,o=Q();(async()=>{var p;const k=await L.query("getTimeblockTaskBlocks",{timeblockColumnId:t.timeblockColumnId}),s=o.activeTimeblock;for(const v of k){let h;const u=s.getTask(v.taskId).getType();switch(u){case"normal":{h=new He({id:v.id,startMinute:v.startMinute,endMinute:v.endMinute,timeblockColumnId:v.timeblockColumnId,task:s.getTask(v.taskId),timeblock:s});break}case"fixed-time":{h=new Ne({id:v.id,startMinute:v.startMinute,endMinute:v.endMinute,timeblockColumnId:v.timeblockColumnId,task:s.getTask(v.taskId),timeblock:s});break}case"fixed-weekly-time":{h=new st({id:v.id,startMinute:v.startMinute,endMinute:v.endMinute,timeblockColumnId:v.timeblockColumnId,task:s.getTask(v.taskId),timeblock:s});break}default:throw new Error(`Unrecognized task type ${u}`)}s.addTaskBlock(h),(p=s.getColumn(v.timeblockColumnId))==null||p.addTaskBlock(v.id)}})();const n=D(()=>{var k,s;return(s=(k=o.activeTimeblock.getColumn(t.timeblockColumnId))==null?void 0:k.getTaskBlocks())!=null?s:[]}),a=D(()=>Ro({taskBlocks:n.value})),l=D(()=>({display:"grid","grid-template-rows":"repeat(1440, 1px)","grid-template-columns":"1fr"}));let i=B(!1);const r=Rt({"grid-column":"1 / span 1","grid-row-start":1,"grid-row-end":61,"background-color":"white"}),c=B();function d(k){const{activeDraggingTaskBlock:s}=o;if(i.value=!0,s===void 0){const p=k.pageY-c.value.getBoundingClientRect().y,v=fe(p);r["grid-row-start"]=v+1,r["grid-row-end"]=v+1+60}else{const p=o.activeTimeblock.getTaskBlock(s.id),v=p.getStartMinute()+(k.pageY-s.initialMouseY),h=fe(v);r["grid-row-start"]=h+1,r["grid-row-end"]=h+1+(p.getEndMinute()-p.getStartMinute()),r["background-color"]=o.activeTimeblock.getTaskBlock(s.id).getTask().getColor()}}function m(){i.value=!1}async function f(k){var h,u,g,w,T;i.value=!1;const s=(u=(h=k.dataTransfer)==null?void 0:h.getData("text"))!=null?u:"",{activeDraggingTaskBlock:p}=o;if(s==="")return;const v=JSON.parse(s);if(v.type===se.taskBoxDrop){const{payload:x}=v,{activeTimeblock:S}=o;if("taskId"in x){const q=k.clientY-c.value.getBoundingClientRect().top,$=Math.round(q/15)*15,A=$+60,N=S.getTask(x.taskId);if(N===void 0){$e("Task not found.");return}let W;switch(N.getType()){case"normal":{W=new He({id:ne(),timeblock:S,task:N,startMinute:$,endMinute:A,timeblockColumnId:t.timeblockColumnId});break}case"fixed-time":{W=new Ne({id:ne(),timeblock:S,task:N,startMinute:$,endMinute:A,timeblockColumnId:t.timeblockColumnId});break}case"fixed-weekly-time":{W=new st({id:ne(),timeblock:S,task:N,startMinute:$,endMinute:A,timeblockColumnId:t.timeblockColumnId}),N.setDayOfWeek(jt().day());break}default:throw new Error(`Unrecognized task type ${N.getType()}`)}S.addTaskBlock(W),(g=S.getColumn(t.timeblockColumnId))==null||g.addTaskBlock(W.getId()),await L.mutation("createTimeblockTaskBlocks",{timeblockColumnId:t.timeblockColumnId,taskBlocks:[{taskBlockId:W.getId(),taskId:x.taskId,startMinute:$,endMinute:A}]})}else if("sourceTaskBlockId"in x){if(p===void 0)return;const q=S.getTaskBlock(x.sourceTaskBlockId),$=q.getStartMinute()+(k.pageY-p.initialMouseY),A=Math.round($/15)*15,N=A+(q.getEndMinute()-q.getStartMinute());if(q===void 0)$e("Task block is undefined.");else{q.setStartMinute(A),q.setEndMinute(N);const W=q.getTimeblockColumnId();(w=S.getColumn(W))==null||w.removeTaskBlock(q.getId()),(T=S.getColumn(t.timeblockColumnId))==null||T.addTaskBlock(q.getId()),await L.mutation("updateTimeblockTaskBlock",{timeblockColumnId:t.timeblockColumnId,taskBlockId:q.getId(),startMinute:A,endMinute:N})}}}}return(k,s)=>(_(),I("div",{ref_key:"timeblockColumnEl",ref:c,style:F(l.value),class:"-z-1 border-b border-gray-200",onDrop:f,onDragover:ue(d,["prevent"]),onDragleave:ue(m,["prevent"])},[i.value?(_(),I("div",{key:0,style:F(R(r)),class:"rounded-md"},null,4)):ve("",!0),M(Go,{style:{"grid-row":"1 / -1","grid-column":"1 / -1"}}),(_(!0),I(Z,null,ce(n.value,(p,v)=>(_(),ee(Jo,{key:p.getId(),"task-block-id":p.getId(),"height-ratio":a.value[v],"timeblock-column-id":e.timeblockColumnId},null,8,["task-block-id","height-ratio","timeblock-column-id"]))),128))],44,Zo))}}),tn=["onClick"],on=G(" Delete "),nn=j({setup(e){const t=Q(),o=D(()=>t.activeTimeblock.getColumns());function n(l){return{"grid-column-start":l+2,"grid-column-end":l+3,"grid-row":"2 / -1"}}async function a(l){t.activeTimeblock.deleteColumn(l),await L.mutation("deleteTimeblockColumn",{columnId:l,timeblockId:t.activeTimeblock.getId()})}return(l,i)=>{const r=te("v-icon");return _(!0),I(Z,null,ce(o.value,(c,d)=>(_(),I(Z,{key:c.getId()},[C("div",{style:F({"grid-column-start":d+2}),class:"column center font-bold"},[C("div",null,"Version "+Y(d+1),1),o.value.length>1&&d===o.value.length-1?(_(),I("button",{key:0,class:"row cursor-pointer rounded-md border-2 border-red-200 pr-[7px] pl-1 text-xs text-red-200 hover:border-red-500 hover:text-red-500",onClick:m=>a(c.getId())},[M(r,{size:"15",icon:R(Ue)},null,8,["icon"]),on],8,tn)):ve("",!0)],4),M(en,{style:F(n(d)),"timeblock-column-id":c.getId(),date:c.getDate()},null,8,["style","timeblock-column-id","date"])],64))),128)}}}),an={style:{"grid-row":"1 / span 1","grid-column":"-1 / span 1"},class:"self-center px-2"},ln={class:"cursor-pointer text-gray-500 hover:text-black"},sn=j({setup(e){function t(i){let r;return i<12?r="AM":i<24?r="PM":r="AM",`${i%12==0?12:i%12} ${r}`}function o({hour:i,minute:r}){return{"grid-row-start":2+(i*60+r),"grid-row-end":1+((i+1)*60+r)}}const n=Q(),a=D(()=>({display:"grid","grid-template-rows":"60px repeat(1440, 1px)","grid-template-columns":`60px repeat(${n.activeTimeblock.getColumns().length}, 1fr) auto`}));async function l(){const i=n.activeTimeblock.getColumns().at(-1),c=i.getTaskBlocks().map(m=>{const f=m.getTask();return{taskId:f.getId(),taskBlockId:ne(),startMinute:m.getStartMinute(),endMinute:m.getEndMinute(),dayOfWeek:f instanceof le?f.getDayOfWeek():void 0,type:m.getType()}});await L.mutation("createTimeblockTaskBlocks",{timeblockColumnId:i.getId(),taskBlocks:c});const d=ne();await L.mutation("addTimeblockColumn",{columnId:d,timeblockId:n.activeTimeblock.getId(),taskBlockIds:c.map(({taskBlockId:m})=>m)}),n.activeTimeblock.addColumn(d)}return(i,r)=>{const c=te("v-icon");return _(),I("div",{style:F(a.value),class:"w-full"},[(_(),I(Z,null,ce(25,d=>C("div",{key:d-1,class:"mt-[-12px] mr-2 text-right text-gray-500",style:F(o({hour:d-1,minute:0}))},Y(t(d-1)),5)),64)),M(nn),C("div",an,[C("div",ln,[M(c,{icon:R(Wt),onClick:l},null,8,["icon"])])])],4)}}}),rn={class:"row mb-2 items-center justify-center"},un={class:"row mr-auto flex-1 gap-2 p-4"},cn={class:"row flex-1 justify-center"},dn={class:"rounded-md px-2 text-xl font-bold"},mn=C("div",{class:"ml-auto flex-1"},null,-1),kn=j({setup(e){const t=Q(),o=D(()=>So(t.activeTimeblock.getDate()).format("LL"));function n(){t.isTaskDockOpen=!t.isTaskDockOpen}return(a,l)=>{const i=te("v-icon"),r=te("router-link");return _(),I("div",rn,[C("div",un,[M(r,{to:"/timeblocks"},{default:P(()=>[M(i,{icon:R(Pt),class:"cursor-pointer"},null,8,["icon"])]),_:1}),M(i,{icon:R(At),class:"cursor-pointer",onClick:n},null,8,["icon"])]),C("div",cn,[C("div",dn,Y(o.value),1)]),mn])}}});function vn(e){switch(e){case"normal":return ae.color;case"fixed-weekly-time":return le.color;case"fixed-time":return ie.color;default:return"white"}}const gn={class:"task-box-editor m-2 self-stretch rounded-lg py-2 text-center"},fn=["value"],hn=["value"],pn=j({props:{name:null,description:null,taskType:null},emits:["update:name","update:description","blur"],setup(e,{emit:t}){const o=e;zt(f=>({"14c7bc2d":n.value}));const n=D(()=>vn(o.taskType)),a=B(),l=B();let i=B(!1);async function r(f){i.value&&f.relatedTarget!==l.value&&(t("blur"),i.value=!1)}async function c(f){i.value&&f.relatedTarget!==a.value&&(t("blur"),i.value=!1)}function d(f){f.key==="Enter"&&l.value.focus()}function m(f){f.key==="Enter"&&l.value.blur()}return(f,k)=>(_(),I("div",gn,[C("input",{ref_key:"taskNameInputEl",ref:a,value:e.name,placeholder:"Task Name",type:"text",class:"w-full px-4 outline-none",onInput:k[0]||(k[0]=s=>t("update:name",s.target.value)),onFocusout:r,onKeydown:d,onFocus:k[1]||(k[1]=s=>i.value=!0)},null,40,fn),C("input",{ref_key:"taskDescriptionInputEl",ref:l,value:e.description,placeholder:"Task Description",type:"text",class:"w-full px-4 text-sm text-gray-500 outline-none",onInput:k[2]||(k[2]=s=>t("update:description",s.target.value)),onFocusout:c,onKeydown:m,onFocus:k[3]||(k[3]=s=>i.value=!0)},null,40,hn)]))}});var rt=Do(pn,[["__scopeId","data-v-55998f26"]]);const bn={class:"row items-center justify-between"},yn={class:"ml-4"},wn={class:"column mx-auto"},Tn={class:"px-2 text-sm text-gray-500"},xn={class:"mr-4"},_n=j({props:{id:null},setup(e){const t=e,o=Q(),n=D(()=>o.activeTimeblock.getTask(t.id)),a=D(()=>({"background-color":n.value.getColor()}));function l(v){var h;(h=v.dataTransfer)==null||h.setData("text",JSON.stringify({type:se.taskBoxDrop,payload:{taskId:t.id}}))}let i=B(!1);function r(){i.value=!0}function c(){i.value=!1}async function d(){o.activeTimeblock.getTask(n.value.getId()).setIsHidden(!0),await L.mutation("hideTimeblockTask",{taskId:n.value.getId()})}let m=B(""),f=B(""),k=B(!1);function s(){var v;m.value=n.value.getName(),f.value=(v=n.value.getDescription())!=null?v:"",k.value=!0}async function p(){m.value!==""&&(k.value=!1,n.value.setName(m.value),n.value.setDescription(f.value),await L.mutation("updateTimeblockTask",{taskId:n.value.getId(),description:f.value,name:m.value}))}return(v,h)=>{const u=te("v-icon");return k.value?(_(),ee(rt,{key:0,name:m.value,"onUpdate:name":h[0]||(h[0]=g=>m.value=g),description:f.value,"onUpdate:description":h[1]||(h[1]=g=>f.value=g),"task-type":n.value.getType(),onBlur:p},null,8,["name","description","task-type"])):(_(),I("div",{key:1,draggable:"true",class:"column m-2 cursor-grab self-stretch rounded-lg py-2 text-center active:cursor-grabbing",style:F(a.value),onDragstart:l,onMouseover:r,onMouseout:c},[C("div",bn,[U(C("div",yn,[M(u,{icon:R(Ft),class:"cursor-pointer text-red-500 transition-all hover:scale-105",onClick:d},null,8,["icon"])],512),[[ge,i.value]]),C("div",wn,[C("div",null,Y(n.value.getName()),1),C("div",Tn,Y(n.value.getDescription()),1)]),U(C("div",xn,[M(u,{icon:R(Vt),class:"cursor-pointer text-green-500 transition-all hover:scale-105",onClick:s},null,8,["icon"])],512),[[ge,i.value]])])],36))}}});var he=J({name:"QItemLabel",props:{overline:Boolean,caption:Boolean,header:Boolean,lines:[Number,String]},setup(e,{slots:t}){const o=E(()=>parseInt(e.lines,10)),n=E(()=>"q-item__label"+(e.overline===!0?" q-item__label--overline text-overline":"")+(e.caption===!0?" q-item__label--caption text-caption":"")+(e.header===!0?" q-item__label--header":"")+(o.value===1?" ellipsis":"")),a=E(()=>e.lines!==void 0&&o.value>1?{overflow:"hidden",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":o.value}:null);return()=>H("div",{style:a.value,class:n.value},oe(t.default))}}),ut=J({name:"QItemSection",props:{avatar:Boolean,thumbnail:Boolean,side:Boolean,top:Boolean,noWrap:Boolean},setup(e,{slots:t}){const o=E(()=>`q-item__section column q-item__section--${e.avatar===!0||e.side===!0||e.thumbnail===!0?"side":"main"}`+(e.top===!0?" q-item__section--top justify-start":" justify-center")+(e.avatar===!0?" q-item__section--avatar":"")+(e.thumbnail===!0?" q-item__section--thumbnail":"")+(e.noWrap===!0?" q-item__section--nowrap":""));return()=>H("div",{class:o.value},oe(t.default))}}),ct=J({name:"QItem",props:z(O(O({},Me),Kt),{tag:{type:String,default:"div"},active:Boolean,clickable:Boolean,dense:Boolean,insetLevel:Number,tabindex:[String,Number],focused:Boolean,manualFocus:Boolean}),emits:["click","keyup"],setup(e,{slots:t,emit:o}){const{proxy:{$q:n}}=de(),a=Ce(e,n),{hasRouterLink:l,hasLink:i,linkProps:r,linkClass:c,linkTag:d,navigateToRouterLink:m}=Qt(),f=V(null),k=V(null),s=E(()=>e.clickable===!0||i.value===!0||e.tag==="label"),p=E(()=>e.disable!==!0&&s.value===!0),v=E(()=>"q-item q-item-type row no-wrap"+(e.dense===!0?" q-item--dense":"")+(a.value===!0?" q-item--dark":"")+(i.value===!0?c.value:e.active===!0?`${e.activeClass!==void 0?` ${e.activeClass}`:""} q-item--active`:"")+(e.disable===!0?" disabled":"")+(p.value===!0?" q-item--clickable q-link cursor-pointer "+(e.manualFocus===!0?"q-manual-focusable":"q-focusable q-hoverable")+(e.focused===!0?" q-manual-focusable--focused":""):"")),h=E(()=>{if(e.insetLevel===void 0)return null;const T=n.lang.rtl===!0?"Right":"Left";return{["padding"+T]:16+e.insetLevel*56+"px"}});function u(T){p.value===!0&&(k.value!==null&&(T.qKeyEvent!==!0&&document.activeElement===f.value?k.value.focus():document.activeElement===k.value&&f.value.focus()),l.value===!0&&m(T),o("click",T))}function g(T){if(p.value===!0&&Ie(T,13)===!0){Je(T),T.qKeyEvent=!0;const x=new MouseEvent("click",T);x.qKeyEvent=!0,f.value.dispatchEvent(x)}o("keyup",T)}function w(){const T=Yt(t.default,[]);return p.value===!0&&T.unshift(H("div",{class:"q-focus-helper",tabindex:-1,ref:k})),T}return()=>{const T={ref:f,class:v.value,style:h.value,onClick:u,onKeyup:g};return p.value===!0?(T.tabindex=e.tabindex||"0",Object.assign(T,r.value)):s.value===!0&&(T["aria-disabled"]="true"),H(d.value,T,w())}}}),Bn=J({name:"QList",props:z(O({},Me),{bordered:Boolean,dense:Boolean,separator:Boolean,padding:Boolean}),setup(e,{slots:t}){const o=de(),n=Ce(e,o.proxy.$q),a=E(()=>"q-list"+(e.bordered===!0?" q-list--bordered":"")+(e.dense===!0?" q-list--dense":"")+(e.separator===!0?" q-list--separator":"")+(n.value===!0?" q-list--dark":"")+(e.padding===!0?" q-list--padding":""));return()=>H("div",{class:a.value},oe(t.default))}}),Mn=J({name:"QBtnGroup",props:{unelevated:Boolean,outline:Boolean,flat:Boolean,rounded:Boolean,push:Boolean,stretch:Boolean,glossy:Boolean,spread:Boolean},setup(e,{slots:t}){const o=E(()=>{const n=["unelevated","outline","flat","rounded","push","stretch","glossy"].filter(a=>e[a]===!0).map(a=>`q-btn-group--${a}`).join(" ");return`q-btn-group row no-wrap${n.length>0?" "+n:""}`+(e.spread===!0?" q-btn-group--spread":" inline")});return()=>H("div",{class:o.value},oe(t.default))}});function Cn(){if(window.getSelection!==void 0){const e=window.getSelection();e.empty!==void 0?e.empty():e.removeAllRanges!==void 0&&(e.removeAllRanges(),Ut.is.mobile!==!0&&e.addRange(document.createRange()))}else document.selection!==void 0&&document.selection.empty()}const In={target:{default:!0},noParentEvent:Boolean,contextMenu:Boolean};function Sn({showing:e,avoidEmit:t,configureAnchorEl:o}){const{props:n,proxy:a,emit:l}=de(),i=V(null);let r;function c(s){return i.value===null?!1:s===void 0||s.touches===void 0||s.touches.length<=1}const d={};o===void 0&&(Object.assign(d,{hide(s){a.hide(s)},toggle(s){a.toggle(s),s.qAnchorHandled=!0},toggleKey(s){Ie(s,13)===!0&&d.toggle(s)},contextClick(s){a.hide(s),Xe(s),Jt(()=>{a.show(s),s.qAnchorHandled=!0})},prevent:Xe,mobileTouch(s){if(d.mobileCleanup(s),c(s)!==!0)return;a.hide(s),i.value.classList.add("non-selectable");const p=s.target;Ge(d,"anchor",[[p,"touchmove","mobileCleanup","passive"],[p,"touchend","mobileCleanup","passive"],[p,"touchcancel","mobileCleanup","passive"],[i.value,"contextmenu","prevent","notPassive"]]),r=setTimeout(()=>{a.show(s),s.qAnchorHandled=!0},300)},mobileCleanup(s){i.value.classList.remove("non-selectable"),clearTimeout(r),e.value===!0&&s!==void 0&&Cn()}}),o=function(s=n.contextMenu){if(n.noParentEvent===!0||i.value===null)return;let p;s===!0?a.$q.platform.is.mobile===!0?p=[[i.value,"touchstart","mobileTouch","passive"]]:p=[[i.value,"mousedown","hide","passive"],[i.value,"contextmenu","contextClick","notPassive"]]:p=[[i.value,"click","toggle","passive"],[i.value,"keyup","toggleKey","passive"]],Ge(d,"anchor",p)});function m(){Xt(d,"anchor")}function f(s){for(i.value=s;i.value.classList.contains("q-anchor--skip");)i.value=i.value.parentNode;o()}function k(){if(n.target===!1||n.target==="")i.value=null;else if(n.target===!0)f(a.$el.parentNode);else{let s=n.target;if(typeof n.target=="string")try{s=document.querySelector(n.target)}catch{s=void 0}s!=null?(i.value=s.$el||s,o()):(i.value=null,console.error(`Anchor: target "${n.target}" not found`))}}return K(()=>n.contextMenu,s=>{i.value!==null&&(m(),o(s))}),K(()=>n.target,()=>{i.value!==null&&m(),k()}),K(()=>n.noParentEvent,s=>{i.value!==null&&(s===!0?m():o())}),Ze(()=>{k(),t!==!0&&n.modelValue===!0&&i.value===null&&l("update:modelValue",!1)}),Se(()=>{clearTimeout(r),m()}),{anchorEl:i,canShow:c,anchorEvents:d}}function Dn(e,t){const o=V(null);let n;function a(r,c){const d=`${c!==void 0?"add":"remove"}EventListener`,m=c!==void 0?c:n;r!==window&&r[d]("scroll",m,De.passive),window[d]("scroll",m,De.passive),n=c}function l(){o.value!==null&&(a(o.value),o.value=null)}const i=K(()=>e.noParentEvent,()=>{o.value!==null&&(l(),t())});return Se(i),{localScrollTarget:o,unconfigureScrollTarget:l,changeScrollEvent:a}}let dt;const{notPassiveCapture:pe}=De,X=[];function be(e){clearTimeout(dt);const t=e.target;if(t===void 0||t.nodeType===8||t.classList.contains("no-pointer-events")===!0)return;let o=et.length-1;for(;o>=0;){const n=et[o].$;if(n.type.name!=="QDialog")break;if(n.props.seamless!==!0)return;o--}for(let n=X.length-1;n>=0;n--){const a=X[n];if((a.anchorEl.value===null||a.anchorEl.value.contains(t)===!1)&&(t===document.body||a.innerRef.value!==null&&a.innerRef.value.contains(t)===!1))e.qClickOutside=!0,a.onClickOutside(e);else return}}function En(e){X.push(e),X.length===1&&(document.addEventListener("mousedown",be,pe),document.addEventListener("touchstart",be,pe))}function mt(e){const t=X.findIndex(o=>o===e);t>-1&&(X.splice(t,1),X.length===0&&(clearTimeout(dt),document.removeEventListener("mousedown",be,pe),document.removeEventListener("touchstart",be,pe)))}let kt,vt;function gt(e){const t=e.split(" ");return t.length!==2?!1:["top","center","bottom"].includes(t[0])!==!0?(console.error("Anchor/Self position must start with one of top/center/bottom"),!1):["left","middle","right","start","end"].includes(t[1])!==!0?(console.error("Anchor/Self position must end with one of left/middle/right/start/end"),!1):!0}function $n(e){return e?!(e.length!==2||typeof e[0]!="number"||typeof e[1]!="number"):!0}const Re={"start#ltr":"left","start#rtl":"right","end#ltr":"right","end#rtl":"left"};["left","middle","right"].forEach(e=>{Re[`${e}#ltr`]=e,Re[`${e}#rtl`]=e});function ft(e,t){const o=e.split(" ");return{vertical:o[0],horizontal:Re[`${o[1]}#${t===!0?"rtl":"ltr"}`]}}function qn(e,t){let{top:o,left:n,right:a,bottom:l,width:i,height:r}=e.getBoundingClientRect();return t!==void 0&&(o-=t[1],n-=t[0],l+=t[1],a+=t[0],i+=t[0],r+=t[1]),{top:o,left:n,right:a,bottom:l,width:i,height:r,middle:n+(a-n)/2,center:o+(l-o)/2}}function On(e){return{top:0,center:e.offsetHeight/2,bottom:e.offsetHeight,left:0,middle:e.offsetWidth/2,right:e.offsetWidth}}function Ln(e){if(Gt.is.ios===!0&&window.visualViewport!==void 0){const r=document.body.style,{offsetLeft:c,offsetTop:d}=window.visualViewport;c!==kt&&(r.setProperty("--q-pe-left",c+"px"),kt=c),d!==vt&&(r.setProperty("--q-pe-top",d+"px"),vt=d)}let t;const{scrollLeft:o,scrollTop:n}=e.el;if(e.absoluteOffset===void 0)t=qn(e.anchorEl,e.cover===!0?[0,0]:e.offset);else{const{top:r,left:c}=e.anchorEl.getBoundingClientRect(),d=r+e.absoluteOffset.top,m=c+e.absoluteOffset.left;t={top:d,left:m,width:1,height:1,right:m+1,center:d,middle:m,bottom:d+1}}let a={maxHeight:e.maxHeight,maxWidth:e.maxWidth,visibility:"visible"};(e.fit===!0||e.cover===!0)&&(a.minWidth=t.width+"px",e.cover===!0&&(a.minHeight=t.height+"px")),Object.assign(e.el.style,a);const l=On(e.el),i={top:t[e.anchorOrigin.vertical]-l[e.selfOrigin.vertical],left:t[e.anchorOrigin.horizontal]-l[e.selfOrigin.horizontal]};Hn(i,t,l,e.anchorOrigin,e.selfOrigin),a={top:i.top+"px",left:i.left+"px"},i.maxHeight!==void 0&&(a.maxHeight=i.maxHeight+"px",t.height>i.maxHeight&&(a.minHeight=a.maxHeight)),i.maxWidth!==void 0&&(a.maxWidth=i.maxWidth+"px",t.width>i.maxWidth&&(a.minWidth=a.maxWidth)),Object.assign(e.el.style,a),e.el.scrollTop!==n&&(e.el.scrollTop=n),e.el.scrollLeft!==o&&(e.el.scrollLeft=o)}function Hn(e,t,o,n,a){const l=o.bottom,i=o.right,r=Zt(),c=window.innerHeight-r,d=document.body.clientWidth;if(e.top<0||e.top+l>c)if(a.vertical==="center")e.top=t[n.vertical]>c/2?Math.max(0,c-l):0,e.maxHeight=Math.min(l,c);else if(t[n.vertical]>c/2){const m=Math.min(c,n.vertical==="center"?t.center:n.vertical===a.vertical?t.bottom:t.top);e.maxHeight=Math.min(l,m),e.top=Math.max(0,m-l)}else e.top=Math.max(0,n.vertical==="center"?t.center:n.vertical===a.vertical?t.top:t.bottom),e.maxHeight=Math.min(l,c-e.top);if(e.left<0||e.left+i>d)if(e.maxWidth=Math.min(i,d),a.horizontal==="middle")e.left=t[n.horizontal]>d/2?Math.max(0,d-i):0;else if(t[n.horizontal]>d/2){const m=Math.min(d,n.horizontal==="middle"?t.middle:n.horizontal===a.horizontal?t.right:t.left);e.maxWidth=Math.min(i,m),e.left=Math.max(0,m-e.maxWidth)}else e.left=Math.max(0,n.horizontal==="middle"?t.middle:n.horizontal===a.horizontal?t.left:t.right),e.maxWidth=Math.min(i,d-e.left)}var Nn=J({name:"QMenu",inheritAttrs:!1,props:z(O(O(O(O({},In),eo),Me),to),{persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:gt},self:{type:String,validator:gt},offset:{type:Array,validator:$n},scrollTarget:{default:void 0},touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}}),emits:[...oo,"click","escape-key"],setup(e,{slots:t,emit:o,attrs:n}){let a=null,l,i,r;const c=de(),{proxy:d}=c,{$q:m}=d,f=V(null),k=V(!1),s=E(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),p=Ce(e,m),{registerTick:v,removeTick:h}=no(),{registerTimeout:u,removeTimeout:g}=ao(),{transition:w,transitionStyle:T}=io(e,k),{localScrollTarget:x,changeScrollEvent:S,unconfigureScrollTarget:q}=Dn(e,Ke),{anchorEl:$,canShow:A}=Sn({showing:k}),{hide:N}=lo({showing:k,canShow:A,handleShow:_t,handleHide:Bt,hideOnRouteChange:s,processOnMount:!0}),{showPortal:W,hidePortal:bt,renderPortal:yt}=so(c,f,Ct),ye={anchorEl:$,innerRef:f,onClickOutside(b){if(e.persistent!==!0&&k.value===!0)return N(b),(b.type==="touchstart"||b.target.classList.contains("q-dialog__backdrop"))&&Je(b),!0}},ze=E(()=>ft(e.anchor||(e.cover===!0?"center middle":"bottom start"),m.lang.rtl)),wt=E(()=>e.cover===!0?ze.value:ft(e.self||"top start",m.lang.rtl)),Tt=E(()=>(e.square===!0?" q-menu--square":"")+(p.value===!0?" q-menu--dark q-dark":"")),xt=E(()=>e.autoClose===!0?{onClick:Mt}:{}),Fe=E(()=>k.value===!0&&e.persistent!==!0);K(Fe,b=>{b===!0?(fo(Te),En(ye)):(tt(Te),mt(ye))});function we(){vo(()=>{let b=f.value;b&&b.contains(document.activeElement)!==!0&&(b=b.querySelector("[autofocus], [data-autofocus]")||b,b.focus({preventScroll:!0}))})}function _t(b){if(h(),g(),a=e.noRefocus===!1?document.activeElement:null,ro(Qe),W(),Ke(),l=void 0,b!==void 0&&(e.touchPosition||e.contextMenu)){const xe=uo(b);if(xe.left!==void 0){const{top:It,left:St}=$.value.getBoundingClientRect();l={left:xe.left-St,top:xe.top-It}}}i===void 0&&(i=K(()=>m.screen.width+"|"+m.screen.height+"|"+e.self+"|"+e.anchor+"|"+m.lang.rtl,re)),e.noFocus!==!0&&document.activeElement.blur(),v(()=>{re(),e.noFocus!==!0&&we()}),u(()=>{m.platform.is.ios===!0&&(r=e.autoClose,f.value.click()),re(),W(!0),o("show",b)},e.transitionDuration)}function Bt(b){h(),g(),Ve(!0),a!==null&&(b===void 0||b.qClickOutside!==!0)&&(a.focus(),a=null),u(()=>{bt(),o("hide",b)},e.transitionDuration)}function Ve(b){l=void 0,i!==void 0&&(i(),i=void 0),(b===!0||k.value===!0)&&(co(Qe),q(),mt(ye),tt(Te)),b!==!0&&(a=null)}function Ke(){($.value!==null||e.scrollTarget!==void 0)&&(x.value=mo($.value,e.scrollTarget),S(x.value,re))}function Mt(b){r!==!0?(go(d,b),o("click",b)):r=!1}function Qe(b){Fe.value===!0&&e.noFocus!==!0&&ho(f.value,b.target)!==!0&&we()}function Te(b){o("escape-key"),N(b)}function re(){const b=f.value;b===null||$.value===null||Ln({el:b,offset:e.offset,anchorEl:$.value,anchorOrigin:ze.value,selfOrigin:wt.value,absoluteOffset:l,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function Ct(){return H(ko,{name:w.value,appear:!0},()=>k.value===!0?H("div",O(z(O({},n),{ref:f,tabindex:-1,class:["q-menu q-position-engine scroll"+Tt.value,n.class],style:[n.style,T.value]}),xt.value),oe(t.default)):null)}return Se(Ve),Object.assign(d,{focus:we,updatePosition:re}),yt}}),Rn=J({name:"QBtnDropdown",props:z(O({},po),{modelValue:Boolean,split:Boolean,dropdownIcon:String,contentClass:[Array,String,Object],contentStyle:[Array,String,Object],cover:Boolean,persistent:Boolean,noRouteDismiss:Boolean,autoClose:Boolean,menuAnchor:{type:String,default:"bottom end"},menuSelf:{type:String,default:"top end"},menuOffset:Array,disableMainBtn:Boolean,disableDropdown:Boolean,noIconAnimation:Boolean}),emits:["update:modelValue","click","before-show","show","before-hide","hide"],setup(e,{slots:t,emit:o}){const{proxy:n}=de(),a=V(e.modelValue),l=V(null),i=E(()=>{const u={"aria-expanded":a.value===!0?"true":"false","aria-haspopup":"true"};return(e.disable===!0||e.split===!1&&e.disableMainBtn===!0||e.disableDropdown===!0)&&(u["aria-disabled"]="true"),u}),r=E(()=>"q-btn-dropdown__arrow"+(a.value===!0&&e.noIconAnimation===!1?" rotate-180":"")+(e.split===!1?" q-btn-dropdown__arrow-container":""));K(()=>e.modelValue,u=>{l.value!==null&&l.value[u?"show":"hide"]()}),K(()=>e.split,h);function c(u){a.value=!0,o("before-show",u)}function d(u){o("show",u),o("update:modelValue",!0)}function m(u){a.value=!1,o("before-hide",u)}function f(u){o("hide",u),o("update:modelValue",!1)}function k(u){o("click",u)}function s(u){yo(u),h(),o("click",u)}function p(u){l.value!==null&&l.value.toggle(u)}function v(u){l.value!==null&&l.value.show(u)}function h(u){l.value!==null&&l.value.hide(u)}return Object.assign(n,{show:v,hide:h,toggle:p}),Ze(()=>{e.modelValue===!0&&v()}),()=>{const u=[H(bo,{class:r.value,name:e.dropdownIcon||n.$q.iconSet.arrow.dropdown})];return e.disableDropdown!==!0&&u.push(H(Nn,{ref:l,class:e.contentClass,style:e.contentStyle,cover:e.cover,fit:!0,persistent:e.persistent,noRouteDismiss:e.noRouteDismiss,autoClose:e.autoClose,anchor:e.menuAnchor,self:e.menuSelf,offset:e.menuOffset,separateClosePopup:!0,onBeforeShow:c,onShow:d,onBeforeHide:m,onHide:f},t.default)),e.split===!1?H(Ee,z(O(z(O({class:"q-btn-dropdown q-btn-dropdown--simple"},e),{disable:e.disable===!0||e.disableMainBtn===!0,noWrap:!0,round:!1}),i.value),{onClick:k}),()=>oe(t.label,[]).concat(u)):H(Mn,{class:"q-btn-dropdown q-btn-dropdown--split no-wrap q-btn-item",outline:e.outline,flat:e.flat,rounded:e.rounded,push:e.push,unelevated:e.unelevated,glossy:e.glossy,stretch:e.stretch},()=>[H(Ee,z(O({class:"q-btn-dropdown--current"},e),{disable:e.disable===!0||e.disableMainBtn===!0,noWrap:!0,iconRight:e.iconRight,round:!1,onClick:s}),t.label),H(Ee,z(O({class:"q-btn-dropdown__arrow-container q-anchor--skip"},i.value),{disable:e.disable===!0||e.disableDropdown===!0,outline:e.outline,flat:e.flat,rounded:e.rounded,push:e.push,size:e.size,color:e.color,textColor:e.textColor,dense:e.dense,ripple:e.ripple}),()=>u)])}}});function ht(e){if(e===!1)return 0;if(e===!0||e===void 0)return 1;const t=parseInt(e,10);return isNaN(t)?0:t}var pt=wo({name:"close-popup",beforeMount(e,{value:t}){const o={depth:ht(t),handler(n){o.depth!==0&&setTimeout(()=>{const a=To(e);a!==void 0&&xo(a,n,o.depth)})},handlerKey(n){Ie(n,13)===!0&&o.handler(n)}};e.__qclosepopup=o,e.addEventListener("click",o.handler),e.addEventListener("keyup",o.handlerKey)},updated(e,{value:t,oldValue:o}){t!==o&&(e.__qclosepopup.depth=ht(t))},beforeUnmount(e){const t=e.__qclosepopup;e.removeEventListener("click",t.handler),e.removeEventListener("keyup",t.handlerKey),delete e.__qclosepopup}});const jn=G("Add Fixed Time Task"),Wn=G(" A task that always occurs at the same time every day. "),Pn=G("Add Fixed Weekly Time Task"),An=G(" A task that always occurs on the same time and day every week. "),zn=j({emits:["select"],setup(e,{emit:t}){return(o,n)=>(_(),I("div",null,[M(Rn,{split:"","dropdown-icon":R(_o),color:"primary",label:"Add Task",class:"mb-2",onClick:n[2]||(n[2]=a=>t("select","normal"))},{default:P(()=>[M(Bn,null,{default:P(()=>[U((_(),ee(ct,{clickable:"",onClick:n[0]||(n[0]=a=>t("select","fixed-time"))},{default:P(()=>[M(ut,null,{default:P(()=>[M(he,null,{default:P(()=>[jn]),_:1}),M(he,{caption:""},{default:P(()=>[Wn]),_:1})]),_:1})]),_:1})),[[pt]]),U((_(),ee(ct,{clickable:"",onClick:n[1]||(n[1]=a=>t("select","fixed-weekly-time"))},{default:P(()=>[M(ut,null,{default:P(()=>[M(he,null,{default:P(()=>[Pn]),_:1}),M(he,{caption:""},{default:P(()=>[An]),_:1})]),_:1})]),_:1})),[[pt]])]),_:1})]),_:1},8,["dropdown-icon"])]))}});function Fn(e,t,o){const n=[];let a=0,l=0;for(;a<e.length&&l<t.length;)o(e[a],t[l])?(n.push(e[a]),a+=1):(n.push(t[l]),l+=1);return[...n,...e.slice(a),...t.slice(l)]}function je(e,t){const o=e.length/2;if(e.length<2)return e;const n=e.splice(0,o);return Fn(je(n,t),je(e,t),t)}const Vn=["onDragover"],Kn={key:0,class:"column pointer-events-none absolute inset-0 top-[45px] mt-10 items-center rounded-md bg-[rgba(255,0,0,0.9)] pt-10 z-10"},Qn=C("div",{class:"text-black"},"Delete Task Block",-1),Yn=C("div",{class:"mb-2 text-3xl font-bold"},"Tasks",-1),Un=j({setup(e){const t=Q(),o=B(!1),n=B(""),a=D(()=>{let h=t.activeTimeblock.getOrderedTaskIds().map(u=>t.activeTimeblock.getTask(u)).filter(u=>!u.getIsHidden());return o.value&&(h=je(h,(u,g)=>u.getName()<g.getName())),n.value!==""&&(h=h.filter(u=>{var g;return u.getName().toLowerCase().includes(n.value.toLowerCase())||((g=u.getDescription())==null?void 0:g.toLowerCase().includes(n.value.toLowerCase()))})),h}),l=B();let i=B(""),r=B(""),c=B(""),d=B(!1);async function m(h){d.value||(c.value=h,d.value=!0,i.value="",r.value="",await Co())}async function f(){if(i.value.trim()==="")i.value="",r.value="",d.value=!1;else{const h=ne();let u;switch(c.value){case"normal":{u=new ae({id:h,name:i.value,description:r.value,isHidden:!1});break}case"fixed-weekly-time":{u=new le({dayOfWeek:void 0,startMinute:void 0,endMinute:void 0,id:h,isHidden:!1,name:i.value,description:r.value});break}case"fixed-time":{u=new ie({endMinute:void 0,id:h,isHidden:!1,name:i.value,startMinute:void 0,description:r.value});break}default:throw new Error(`Unrecognized task type ${c.value}`)}t.activeTimeblock.addTask(u);const g=i.value,w=r.value;i.value="",r.value="",d.value=!1;try{await L.mutation("createTimeblockTask",{id:h,name:g,description:w,type:c.value})}catch(T){$e(T)}}}let k=B(!1);function s(){t.activeDraggingTaskBlock!==void 0&&(k.value=!0)}function p(){k.value=!1}async function v(h){var w,T,x;k.value=!1;const u=(T=(w=h.dataTransfer)==null?void 0:w.getData("text"))!=null?T:"";if(u==="")return;const g=JSON.parse(u);if(g.type===se.taskBoxDrop){const{payload:S}=g;if("sourceTaskBlockId"in S){const $=t.activeTimeblock.getTaskBlock(S.sourceTaskBlockId).getTimeblockColumnId();(x=t.activeTimeblock.getColumn($))==null||x.removeTaskBlock(S.sourceTaskBlockId),await L.mutation("deleteTimeblockTaskBlock",{taskBlockId:S.sourceTaskBlockId,timeblockColumnId:$})}}}return(h,u)=>{const g=te("v-icon");return U((_(),I("div",{class:"column relative w-[250px] shrink-0 items-center",onDrop:v,onDragover:ue(s,["prevent"]),onDragleave:p},[k.value?(_(),I("div",Kn,[M(g,{size:50,icon:R(Ue)},null,8,["icon"]),Qn])):ve("",!0),Yn,M(zn,{onSelect:m}),M(Bo,{modelValue:o.value,"onUpdate:modelValue":u[0]||(u[0]=w=>o.value=w),label:"Sort Tasks by Name"},null,8,["modelValue"]),U(C("input",{"onUpdate:modelValue":u[1]||(u[1]=w=>n.value=w),class:"input input-sm input-bordered my-2",placeholder:"Search Tasks"},null,512),[[Mo,n.value]]),U(M(rt,{ref_key:"timeblockTaskBoxEditorEl",ref:l,name:i.value,"onUpdate:name":u[2]||(u[2]=w=>i.value=w),description:r.value,"onUpdate:description":u[3]||(u[3]=w=>r.value=w),"task-type":c.value,onBlur:f},null,8,["name","description","task-type"]),[[ge,d.value]]),(_(!0),I(Z,null,ce(a.value,w=>(_(),ee(_n,{id:w.getId(),key:w.getId()},null,8,["id"]))),128))],40,Vn)),[[ge,R(t).isTaskDockOpen]])}}});class Jn{constructor({timeblock:t,id:o}){y(this,"timeblock");y(this,"id");y(this,"taskBlockIds");this.id=o,this.timeblock=t,this.taskBlockIds=new Set}getDate(){return this.timeblock.getDate()}getId(){return this.id}setTimeblock(t){this.timeblock=t}getTimeblock(){return this.timeblock}addTaskBlock(t){const o=this.timeblock.getTaskBlock(t);this.taskBlockIds.add(t),o.setTimeblockColumnId(this.getId())}removeTaskBlock(t){this.timeblock.getTaskBlock(t).setTimeblockColumnId(void 0),this.taskBlockIds.delete(t)}getTaskBlocks(){return[...this.taskBlockIds.values()].map(t=>this.timeblock.getTaskBlock(t))}}class Xn{constructor({id:t,date:o}){y(this,"id");y(this,"date");y(this,"columns");y(this,"taskMap");y(this,"taskBlockMap");y(this,"orderedTaskIds");y(this,"taskBlockToColumnNumberMap");this.id=t,this.date=o,this.taskMap=new Map,this.taskBlockMap=new Map,this.orderedTaskIds=[],this.columns=[]}getId(){return this.id}addTask(t,o=0){this.taskMap.set(t.getId(),t),this.orderedTaskIds.splice(o,0,t.getId())}removeTask(t){this.taskMap.delete(t)}getTask(t){const o=this.taskMap.get(t);if(o===void 0)throw new Error(`Task with ID ${t} not found.`);return o}getTaskBlock(t){const o=this.taskBlockMap.get(t);if(o===void 0)throw new Error(`Task block with ID ${t} not found.`);return o}addTaskBlock(t){this.taskBlockMap.set(t.getId(),t)}getOrderedTaskIds(){return this.orderedTaskIds}addColumn(t){this.columns.push(new Jn({timeblock:this,id:t}))}getColumn(t){return this.columns.find(o=>o.getId()===t)}deleteColumn(t){const o=this.columns.findIndex(n=>n.getId()===t);if(o===-1)throw new Error("Column not found.");this.columns.splice(o,1)}getDate(){return this.date}setDate(t){this.date=t}getColumns(){return this.columns}}const Gn={key:0},Zn={key:1,class:"column"},ea={class:"row px-4"},sa=j({setup(e){const t=Io(),o=D(()=>t.params),n=D(()=>o.value.id),a=Q();Be(()=>o.value.id,()=>{a.activeTimeblockId=o.value.id});let l=B(!0);return(async()=>{var d,m,f,k,s,p,v,h;const[i,r,c]=await Promise.all([L.query("getTimeblock",{timeblockId:o.value.id}),L.query("getTimeblockTasks",{limit:10,skip:0}),L.query("getTimeblockColumns",{timeblockId:o.value.id})]);if(!a.hasTimeblock(n.value)){const u=new Xn({id:n.value,date:i.date});for(const g of r){let w;switch(g.type){case"normal":{w=new ae({id:g.id,name:g.name,description:(d=g.description)!=null?d:"",isHidden:g.isHidden});break}case"fixed-time":{w=new ie({id:g.id,name:g.name,description:(m=g.description)!=null?m:"",isHidden:g.isHidden,startMinute:(f=g.startMinute)!=null?f:void 0,endMinute:(k=g.endMinute)!=null?k:void 0});break}case"fixed-weekly-time":{w=new le({id:g.id,name:g.name,description:(s=g.description)!=null?s:"",isHidden:g.isHidden,startMinute:(p=g.startMinute)!=null?p:void 0,endMinute:(v=g.endMinute)!=null?v:void 0,dayOfWeek:(h=g.dayOfWeek)!=null?h:void 0});break}default:throw new Error(`Unrecognized task type ${g.type}`)}u.addTask(w)}a.addTimeblock(u);for(const g of c)u.addColumn(g.id)}a.activeTimeblockId=n.value,l.value=!1})(),(i,r)=>l.value?(_(),I("div",Gn,[M(Eo)])):(_(),I("div",Zn,[M(kn),C("div",ea,[M(Un),M(sn)])]))}});export{sa as default};
