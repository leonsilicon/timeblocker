var Dt=Object.defineProperty,St=Object.defineProperties;var Et=Object.getOwnPropertyDescriptors;var Qe=Object.getOwnPropertySymbols;var $t=Object.prototype.hasOwnProperty,qt=Object.prototype.propertyIsEnumerable;var _e=(e,t,o)=>t in e?Dt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,$=(e,t)=>{for(var o in t||(t={}))$t.call(t,o)&&_e(e,o,t[o]);if(Qe)for(var o of Qe(t))qt.call(t,o)&&_e(e,o,t[o]);return e},z=(e,t)=>St(e,Et(t));var y=(e,t,o)=>(_e(e,typeof t!="symbol"?t+"":t,o),o);import{P as Ot,R as Ht,E as _,S as Be,q as j,a as W,C as S,T as Lt,o as T,b as M,p as C,U as ue,t as X,x as Y,I as ve,V as F,F as G,v as ce,J as Z,W as Rt,e as B,l as jt,r as ee,X as Ye,Y as Wt,w as P,Z as Nt,_ as Pt,$ as At,G as te,a0 as ge,a1 as zt,a2 as Ft,a3 as U,a4 as E,a5 as L,a6 as oe,a7 as Me,a8 as Vt,a9 as Ce,aa as Kt,ab as V,ac as de,ad as Ie,ae as Ue,af as Qt,ag as Yt,ah as Je,ai as Ut,aj as Xe,ak as K,al as Ge,am as De,an as Jt,ao as Se,ap as Ze,aq as Xt,ar as Gt,as as Zt,at as eo,au as to,av as oo,aw as no,ax as ao,ay as io,az as so,aA as lo,aB as ro,aC as uo,aD as et,aE as co,aF as mo,aG as ko,aH as vo,aI as go,aJ as fo,aK as ho,aL as po,aM as Ee,aN as bo,aO as yo,aP as wo,aQ as To,aR as xo,aS as _o,B as Bo}from"./vendor.334381a3.js";import{u as Q,t as Mo}from"./date.120b2e35.js";import{c as q,d as $e}from"./index.e5b71ef8.js";import{_ as Co}from"./plugin-vue_export-helper.21dcd24c.js";import{C as Io}from"./circle-spinner.1dca1f40.js";let Do=e=>crypto.getRandomValues(new Uint8Array(e)),So=(e,t,o)=>{let n=(2<<Math.log(e.length-1)/Math.LN2)-1,a=-~(1.6*n*t/e.length);return(s=t)=>{let i="";for(;;){let r=o(a),u=a;for(;u--;)if(i+=e[r[u]&n]||"",i.length===s)return i}}},Eo=(e,t=21)=>So(e,t,Do);var $o=["2g1c","2 girls 1 cup","acrotomophilia","alabama hot pocket","alaskan pipeline","anal","anilingus","anus","apeshit","arsehole","ass","asshole","assmunch","auto erotic","autoerotic","babeland","baby batter","baby juice","ball gag","ball gravy","ball kicking","ball licking","ball sack","ball sucking","bangbros","bangbus","bareback","barely legal","barenaked","bastard","bastardo","bastinado","bbw","bdsm","beaner","beaners","beaver cleaver","beaver lips","beastiality","bestiality","big black","big breasts","big knockers","big tits","bimbos","birdlock","bitch","bitches","black cock","blonde action","blonde on blonde action","blowjob","blow job","blow your load","blue waffle","blumpkin","bollocks","bondage","boner","boob","boobs","booty call","brown showers","brunette action","bukkake","bulldyke","bullet vibe","bullshit","bung hole","bunghole","busty","butt","buttcheeks","butthole","camel toe","camgirl","camslut","camwhore","carpet muncher","carpetmuncher","chocolate rosebuds","cialis","circlejerk","cleveland steamer","clit","clitoris","clover clamps","clusterfuck","cock","cocks","coprolagnia","coprophilia","cornhole","coon","coons","creampie","cum","cumming","cumshot","cumshots","cunnilingus","cunt","darkie","date rape","daterape","deep throat","deepthroat","dendrophilia","dick","dildo","dingleberry","dingleberries","dirty pillows","dirty sanchez","doggie style","doggiestyle","doggy style","doggystyle","dog style","dolcett","domination","dominatrix","dommes","donkey punch","double dong","double penetration","dp action","dry hump","dvda","eat my ass","ecchi","ejaculation","erotic","erotism","escort","eunuch","fag","faggot","fecal","felch","fellatio","feltch","female squirting","femdom","figging","fingerbang","fingering","fisting","foot fetish","footjob","frotting","fuck","fuck buttons","fuckin","fucking","fucktards","fudge packer","fudgepacker","futanari","gangbang","gang bang","gay sex","genitals","giant cock","girl on","girl on top","girls gone wild","goatcx","goatse","god damn","gokkun","golden shower","goodpoop","goo girl","goregasm","grope","group sex","g-spot","guro","hand job","handjob","hard core","hardcore","hentai","homoerotic","honkey","hooker","horny","hot carl","hot chick","how to kill","how to murder","huge fat","humping","incest","intercourse","jack off","jail bait","jailbait","jelly donut","jerk off","jigaboo","jiggaboo","jiggerboo","jizz","juggs","kike","kinbaku","kinkster","kinky","knobbing","leather restraint","leather straight jacket","lemon party","livesex","lolita","lovemaking","make me come","male squirting","masturbate","masturbating","masturbation","menage a trois","milf","missionary position","mong","motherfucker","mound of venus","mr hands","muff diver","muffdiving","nambla","nawashi","negro","neonazi","nigga","nigger","nig nog","nimphomania","nipple","nipples","nsfw","nsfw images","nude","nudity","nutten","nympho","nymphomania","octopussy","omorashi","one cup two girls","one guy one jar","orgasm","orgy","paedophile","paki","panties","panty","pedobear","pedophile","pegging","penis","phone sex","piece of shit","pikey","pissing","piss pig","pisspig","playboy","pleasure chest","pole smoker","ponyplay","poof","poon","poontang","punany","poop chute","poopchute","porn","porno","pornography","prince albert piercing","pthc","pubes","pussy","queaf","queef","quim","raghead","raging boner","rape","raping","rapist","rectum","reverse cowgirl","rimjob","rimming","rosy palm","rosy palm and her 5 sisters","rusty trombone","sadism","santorum","scat","schlong","scissoring","semen","sex","sexcam","sexo","sexy","sexual","sexually","sexuality","shaved beaver","shaved pussy","shemale","shibari","shit","shitblimp","shitty","shota","shrimping","skeet","slanteye","slut","s&m","smut","snatch","snowballing","sodomize","sodomy","spastic","spic","splooge","splooge moose","spooge","spread legs","spunk","strap on","strapon","strappado","strip club","style doggy","suck","sucks","suicide girls","sultry women","swastika","swinger","tainted love","taste my","tea bagging","threesome","throating","thumbzilla","tied up","tight white","tit","tits","titties","titty","tongue in a","topless","tosser","towelhead","tranny","tribadism","tub girl","tubgirl","tushy","twat","twink","twinkie","two girls one cup","undressing","upskirt","urethra play","urophilia","vagina","venus mound","viagra","vibrator","violet wand","vorarephilia","voyeur","voyeurweb","voyuer","vulva","wank","wetback","wet dream","white power","whore","worldsex","wrapping men","wrinkled starfish","xx","xxx","yaoi","yellow showers","yiffy","zoophilia","\u{1F595}"];function qo(e){const t=e.replace(/1/g,"i").replace(/3/g,"e").replace(/5/g,"s").replace(/8/g,"b").replace(/0/g,"o");for(const o of $o){const n=o.replace(/ /g,"").replace("l","i");if(new RegExp(n,"gi").test(t))return!0}return!1}function Oo(e){const t=e("6789BCDFGHJKLMNPQRTWbcdfghjkmnpqrtwz");return function(o=30){let n=t(o);for(;qo(n);)n=t(o);return n}}const ne=Oo(Eo),We=class{constructor({id:t,name:o,description:n,color:a,isHidden:s}){y(this,"type");y(this,"id");y(this,"name");y(this,"color");y(this,"description");y(this,"isHidden");this.id=t,this.setName(o),this.setColor(a!=null?a:We.color),n!==void 0&&this.setDescription(n),this.type="normal",this.setIsHidden(s)}setName(t){this.name=t}getType(){return this.type}getName(){return this.name}getId(){return this.id}getColor(){return this.color}setColor(t){this.color=t}getIsHidden(){return this.isHidden}setIsHidden(t){this.isHidden=t}getDescription(){return this.description}setDescription(t){this.description=t}removeDescription(){this.description=void 0}};let ae=We;y(ae,"color","#ffcccc");const Ne=class extends ae{constructor(t){super(t);y(this,"startMinute");y(this,"endMinute");this.setColor(Ne.color),this.type="fixed-time",this.setStartMinute(t.startMinute),this.setEndMinute(t.endMinute)}getStartMinute(){return this.startMinute}setStartMinute(t){this.startMinute=t}getEndMinute(){return this.endMinute}setEndMinute(t){this.endMinute=t}};let ie=Ne;y(ie,"color","#ffd9b3");const Pe=class extends ie{constructor(t){super(t);y(this,"dayOfWeek");this.setColor(Pe.color),this.type="fixed-weekly-time",this.setDayOfWeek(t.dayOfWeek)}setDayOfWeek(t){if(t!==void 0&&(t<0||t>6))throw new Error("Day of week must be between 0 and 6 inclusive.");this.dayOfWeek=t}getDayOfWeek(){return this.dayOfWeek}};let se=Pe;y(se,"color","#e6ffe6");function Ho({taskBlocks:e}){const t=[];for(const o of e){const n=o.getStartMinute(),a=o.getEndMinute();t.push(a-n)}return t}function Lo(e){return Ot()?(Ht(e),!0):!1}const me=typeof window!="undefined",Ro=e=>typeof e=="string",qe=()=>{},tt=me?window:void 0;me&&window.document;me&&window.navigator;me&&window.location;function ke(...e){let t,o,n,a;if(Ro(e[0])?([o,n,a]=e,t=tt):[t,o,n,a]=e,!t)return qe;let s=qe;const i=Be(()=>j(t),u=>{s(),!!u&&(u.addEventListener(o,n,a),s=()=>{u.removeEventListener(o,n,a),s=qe})},{immediate:!0,flush:"post"}),r=()=>{i(),s()};return Lo(r),r}const Oe=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},He="__vueuse_ssr_handlers__";Oe[He]=Oe[He]||{};Oe[He];function jo(e={}){const{type:t="page",touch:o=!0,resetOnTouchEnds:n=!1,initialValue:a={x:0,y:0},window:s=tt}=e,i=_(a.x),r=_(a.y),u=_(null),c=v=>{t==="page"?(i.value=v.pageX,r.value=v.pageY):t==="client"&&(i.value=v.clientX,r.value=v.clientY),u.value="mouse"},d=()=>{i.value=a.x,r.value=a.y},f=v=>{if(v.touches.length>0){const l=v.touches[0];t==="page"?(i.value=l.pageX,r.value=l.pageY):t==="client"&&(i.value=l.clientX,r.value=l.clientY),u.value="touch"}};return s&&(ke(s,"mousemove",c,{passive:!0}),ke(s,"dragover",c,{passive:!0}),o&&(ke(s,"touchstart",f,{passive:!0}),ke(s,"touchmove",f,{passive:!0}),n&&ke(s,"touchend",d,{passive:!0}))),{x:i,y:r,sourceType:u}}var ot,nt;me&&(window==null?void 0:window.navigator)&&((ot=window==null?void 0:window.navigator)==null?void 0:ot.platform)&&/iP(ad|hone|od)/.test((nt=window==null?void 0:window.navigator)==null?void 0:nt.platform);var Wo=Object.defineProperty,at=Object.getOwnPropertySymbols,No=Object.prototype.hasOwnProperty,Po=Object.prototype.propertyIsEnumerable,it=(e,t,o)=>t in e?Wo(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,Ao=(e,t)=>{for(var o in t||(t={}))No.call(t,o)&&it(e,o,t[o]);if(at)for(var o of at(t))Po.call(t,o)&&it(e,o,t[o]);return e};const zo={top:0,left:0,bottom:0,right:0,height:0,width:0};Ao({text:""},zo);var le;(function(e){e.taskBoxDrop="task-box-drop"})(le||(le={}));function fe(e){return Math.round(e/15)*15}const Fo=["onMousedown"],Vo={key:0,class:"text-sm text-gray-500"},Ko=["onMousedown"],Qo=W({props:{timeblockColumnId:null,taskBlockId:null,heightRatio:null},setup(e){const t=e;let o=_({});const n=Q(),a=S(()=>n.activeTimeblock.getTaskBlock(t.taskBlockId)),s=S(()=>a.value.getTask()),i=S(()=>({"grid-column":"1 / span 1","grid-row-start":1+a.value.getStartMinute(),"grid-row-end":1+a.value.getEndMinute(),"background-color":a.value.getTask().getColor()}));let r=_(!1),u=_(void 0),c=_(!1),d=_(void 0);function f(x){var I;if(r.value||c.value){x.preventDefault();return}n.activeDraggingTaskBlock={id:t.taskBlockId,initialMouseY:x.pageY},(I=x.dataTransfer)==null||I.setData("text",JSON.stringify({type:le.taskBoxDrop,payload:{sourceTaskBlockId:t.taskBlockId}}))}function v(){n.activeDraggingTaskBlock=void 0}const l=_(),g=jo(),m=Lt(g,"y");function p(x){r.value=!0,u.value=x.pageY}window.addEventListener("mouseup",async()=>{if(!r.value)return;r.value=!1;const x=h();n.activeTimeblock.getTaskBlock(t.taskBlockId).setStartMinute(x),await q.mutation("updateTimeblockTaskBlock",{timeblockColumnId:t.timeblockColumnId,taskBlockId:t.taskBlockId,startMinute:x}),u.value=void 0,o.value={}});function k(x){c.value=!0,d.value=x.pageY}window.addEventListener("mouseup",async()=>{if(!c.value)return;c.value=!1;const x=D();n.activeTimeblock.getTaskBlock(t.taskBlockId).setEndMinute(x),await q.mutation("updateTimeblockTaskBlock",{timeblockColumnId:t.timeblockColumnId,taskBlockId:t.taskBlockId,endMinute:x}),d.value=void 0,o.value={}});function h(){return u.value===void 0?a.value.getStartMinute():Math.min(a.value.getEndMinute()-16,fe(a.value.getStartMinute()+(m.value-u.value)))}function D(){return d.value===void 0?a.value.getEndMinute():Math.max(a.value.getStartMinute()+16,fe(a.value.getEndMinute()+(m.value-d.value)))}Be(()=>[r.value,c.value,m.value],()=>{r.value&&u.value!==void 0?o.value={"grid-row-start":1+h()}:c.value&&d.value!==void 0&&(o.value={"grid-row-end":1+D()})});const w=S(()=>r.value?D()-h()>30:a.value.getEndMinute()-a.value.getStartMinute()>30);return(x,I)=>(T(),M("div",{ref_key:"taskBlockEl",ref:l,draggable:"true",class:"column center relative cursor-grab rounded-md active:cursor-grabbing",style:F([i.value,o.value]),onDragstart:f,onDragend:v},[C("div",{class:"absolute inset-x-0 top-0 h-[4px] cursor-ns-resize",onMousedown:ue(p,["stop"])},null,40,Fo),X(" "+Y(s.value.getName())+" ",1),w.value?(T(),M("div",Vo,Y(s.value.getDescription()),1)):ve("",!0),C("div",{class:"absolute inset-x-0 bottom-0 h-[4px] cursor-ns-resize",onMousedown:ue(k,["stop"])},null,40,Ko)],36))}}),Yo=W({props:{startDayMinute:null,endDayMinute:null},setup(e){const t=e,o=S(()=>({"grid-row-start":1+t.startDayMinute,"grid-row-end":1+t.endDayMinute,"grid-column":"1 / span 1"}));return(n,a)=>(T(),M("div",{style:F(o.value),class:"-z-1 h-full w-full border-x border-t border-gray-200"},null,4))}}),Uo=W({setup(e){const t=S(()=>({display:"grid","grid-template-rows":"repeat(1440, 1px)","grid-template-columns":"1fr"})),o=Array.from({length:24}).map((n,a)=>a*60);return(n,a)=>(T(),M("div",{style:F(t.value),class:"border-b border-gray-200"},[(T(!0),M(G,null,ce(j(o),s=>(T(),Z(Yo,{key:s,"start-day-minute":s,"end-day-minute":s+60},null,8,["start-day-minute","end-day-minute"]))),128))],4))}});class Le{constructor({id:t,task:o,startMinute:n,endMinute:a,timeblock:s,timeblockColumnId:i}){y(this,"type");y(this,"task");y(this,"id");y(this,"startMinute");y(this,"endMinute");y(this,"timeblock");y(this,"timeblockColumnId");this.id=t,this.timeblock=s,this.task=o,this.type="normal",this.setStartMinute(n),this.setEndMinute(a),this.setTimeblockColumnId(i)}getId(){return this.id}getTask(){return this.task}setTask(t){this.task=t}getStartMinute(){return this.startMinute}setStartMinute(t){if(t===void 0)throw new Error("startMinute cannot be undefined.");if(t<0||t>1440)throw new Error(`Minute must be between 0 and 1440, received ${t}`);this.startMinute=t}getEndMinute(){return this.endMinute}setEndMinute(t){if(t===void 0)throw new Error("endMinute cannot be undefined.");if(t<0||t>1440)throw new Error(`Minute must be between 0 and 1440, received ${t}`);this.endMinute=t}getTimeblockColumnId(){return this.timeblockColumnId}setTimeblockColumnId(t){this.timeblockColumnId=t}getType(){return this.type}}class Re extends Le{constructor(t){super(t);y(this,"task");this.task=t.task}getTask(){return this.task}setTask(t){this.task=t}getStartMinute(){return this.getTask().getStartMinute()}setStartMinute(t){this.getTask().setStartMinute(t)}getEndMinute(){return this.getTask().getEndMinute()}setEndMinute(t){this.getTask().setEndMinute(t)}}class st extends Re{constructor(t){super(t);y(this,"task");this.task=t.task}getTask(){return this.task}setTask(t){this.task=t}}const Jo=["onDragover","onDragleave"],Xo=W({props:{timeblockColumnId:null,date:null},setup(e){const t=e,o=Q();(async()=>{var g;const v=await q.query("getTimeblockTaskBlocks",{timeblockColumnId:t.timeblockColumnId}),l=o.activeTimeblock;for(const m of v){let p;const k=l.getTask(m.taskId).getType();switch(k){case"normal":{p=new Le({id:m.id,startMinute:m.startMinute,endMinute:m.endMinute,timeblockColumnId:m.timeblockColumnId,task:l.getTask(m.taskId),timeblock:l});break}case"fixed-time":{p=new Re({id:m.id,startMinute:m.startMinute,endMinute:m.endMinute,timeblockColumnId:m.timeblockColumnId,task:l.getTask(m.taskId),timeblock:l});break}case"fixed-weekly-time":{p=new st({id:m.id,startMinute:m.startMinute,endMinute:m.endMinute,timeblockColumnId:m.timeblockColumnId,task:l.getTask(m.taskId),timeblock:l});break}default:throw new Error(`Unrecognized task type ${k}`)}l.addTaskBlock(p),(g=l.getColumn(m.timeblockColumnId))==null||g.addTaskBlock(m.id)}})();const n=S(()=>{var v,l;return(l=(v=o.activeTimeblock.getColumn(t.timeblockColumnId))==null?void 0:v.getTaskBlocks())!=null?l:[]}),a=S(()=>Ho({taskBlocks:n.value})),s=S(()=>({display:"grid","grid-template-rows":"repeat(1440, 1px)","grid-template-columns":"1fr"}));let i=_(!1);const r=Rt({"grid-column":"1 / span 1","grid-row-start":1,"grid-row-end":61,"background-color":"white"}),u=_();function c(v){const{activeDraggingTaskBlock:l}=o;if(i.value=!0,l===void 0){const g=v.pageY-u.value.getBoundingClientRect().y,m=fe(g);r["grid-row-start"]=m+1,r["grid-row-end"]=m+1+60}else{const g=o.activeTimeblock.getTaskBlock(l.id),m=g.getStartMinute()+(v.pageY-l.initialMouseY),p=fe(m);r["grid-row-start"]=p+1,r["grid-row-end"]=p+1+(g.getEndMinute()-g.getStartMinute()),r["background-color"]=o.activeTimeblock.getTaskBlock(l.id).getTask().getColor()}}function d(){i.value=!1}async function f(v){var p,k,h,D,w;i.value=!1;const l=(k=(p=v.dataTransfer)==null?void 0:p.getData("text"))!=null?k:"",{activeDraggingTaskBlock:g}=o;if(l==="")return;const m=JSON.parse(l);if(m.type===le.taskBoxDrop){const{payload:x}=m,{activeTimeblock:I}=o;if("taskId"in x){const O=v.clientY-u.value.getBoundingClientRect().top,H=Math.round(O/15)*15,A=H+60,R=I.getTask(x.taskId);if(R===void 0){$e("Task not found.");return}let N;switch(R.getType()){case"normal":{N=new Le({id:ne(),timeblock:I,task:R,startMinute:H,endMinute:A,timeblockColumnId:t.timeblockColumnId});break}case"fixed-time":{N=new Re({id:ne(),timeblock:I,task:R,startMinute:H,endMinute:A,timeblockColumnId:t.timeblockColumnId});break}case"fixed-weekly-time":{N=new st({id:ne(),timeblock:I,task:R,startMinute:H,endMinute:A,timeblockColumnId:t.timeblockColumnId}),R.setDayOfWeek(jt().day());break}default:throw new Error(`Unrecognized task type ${R.getType()}`)}I.addTaskBlock(N),(h=I.getColumn(t.timeblockColumnId))==null||h.addTaskBlock(N.getId()),await q.mutation("createTimeblockTaskBlocks",{timeblockColumnId:t.timeblockColumnId,taskBlocks:[{taskBlockId:N.getId(),taskId:x.taskId,startMinute:H,endMinute:A}]})}else if("sourceTaskBlockId"in x){if(g===void 0)return;const O=I.getTaskBlock(x.sourceTaskBlockId),H=O.getStartMinute()+(v.pageY-g.initialMouseY),A=Math.round(H/15)*15,R=A+(O.getEndMinute()-O.getStartMinute());if(O===void 0)$e("Task block is undefined.");else{O.setStartMinute(A),O.setEndMinute(R);const N=O.getTimeblockColumnId();(D=I.getColumn(N))==null||D.removeTaskBlock(O.getId()),(w=I.getColumn(t.timeblockColumnId))==null||w.addTaskBlock(O.getId()),await q.mutation("updateTimeblockTaskBlock",{timeblockColumnId:t.timeblockColumnId,taskBlockId:O.getId(),startMinute:A,endMinute:R})}}}}return(v,l)=>(T(),M("div",{ref_key:"timeblockColumnEl",ref:u,style:F(s.value),class:"-z-1 border-b border-gray-200",onDrop:f,onDragover:ue(c,["prevent"]),onDragleave:ue(d,["prevent"])},[i.value?(T(),M("div",{key:0,style:F(j(r)),class:"rounded-md"},null,4)):ve("",!0),B(Uo,{style:{"grid-row":"1 / -1","grid-column":"1 / -1"}}),(T(!0),M(G,null,ce(n.value,(g,m)=>(T(),Z(Qo,{key:g.getId(),"task-block-id":g.getId(),"height-ratio":a.value[m],"timeblock-column-id":e.timeblockColumnId},null,8,["task-block-id","height-ratio","timeblock-column-id"]))),128))],44,Jo))}}),Go=["onClick"],Zo=X(" Delete "),en=W({setup(e){const t=Q(),o=S(()=>t.activeTimeblock.getColumns());function n(s){return{"grid-column-start":s+2,"grid-column-end":s+3,"grid-row":"2 / -1"}}async function a(s){t.activeTimeblock.deleteColumn(s),await q.mutation("deleteTimeblockColumn",{columnId:s,timeblockId:t.activeTimeblock.getId()})}return(s,i)=>{const r=ee("v-icon");return T(!0),M(G,null,ce(o.value,(u,c)=>(T(),M(G,{key:u.getId()},[C("div",{style:F({"grid-column-start":c+2}),class:"column center font-bold"},[C("div",null,"Version "+Y(c+1),1),o.value.length>1&&c===o.value.length-1?(T(),M("button",{key:0,class:"row cursor-pointer rounded-md border-2 border-red-200 pr-[7px] pl-1 text-xs text-red-200 hover:border-red-500 hover:text-red-500",onClick:d=>a(u.getId())},[B(r,{size:"15",icon:j(Ye)},null,8,["icon"]),Zo],8,Go)):ve("",!0)],4),B(Xo,{style:F(n(c)),"timeblock-column-id":u.getId(),date:u.getDate()},null,8,["style","timeblock-column-id","date"])],64))),128)}}}),tn={style:{"grid-row":"1 / span 1","grid-column":"-1 / span 1"},class:"self-center px-2"},on={class:"cursor-pointer text-gray-500 hover:text-black"},nn=W({setup(e){function t(i){let r;return i<12?r="AM":i<24?r="PM":r="AM",`${i%12==0?12:i%12} ${r}`}function o({hour:i,minute:r}){return{"grid-row-start":2+(i*60+r),"grid-row-end":1+((i+1)*60+r)}}const n=Q(),a=S(()=>({display:"grid","grid-template-rows":"60px repeat(1440, 1px)","grid-template-columns":`60px repeat(${n.activeTimeblock.getColumns().length}, 1fr) auto`}));async function s(){const i=n.activeTimeblock.getColumns().at(-1),u=i.getTaskBlocks().map(d=>{const f=d.getTask();return{taskId:f.getId(),taskBlockId:ne(),startMinute:d.getStartMinute(),endMinute:d.getEndMinute(),dayOfWeek:f instanceof se?f.getDayOfWeek():void 0,type:d.getType()}});await q.mutation("createTimeblockTaskBlocks",{timeblockColumnId:i.getId(),taskBlocks:u});const c=ne();await q.mutation("addTimeblockColumn",{columnId:c,timeblockId:n.activeTimeblock.getId(),taskBlockIds:u.map(({taskBlockId:d})=>d)}),n.activeTimeblock.addColumn(c)}return(i,r)=>{const u=ee("v-icon");return T(),M("div",{style:F(a.value),class:"w-full"},[(T(),M(G,null,ce(25,c=>C("div",{key:c-1,class:"mt-[-12px] mr-2 text-right text-gray-500",style:F(o({hour:c-1,minute:0}))},Y(t(c-1)),5)),64)),B(en),C("div",tn,[C("div",on,[B(u,{icon:j(Wt),onClick:s},null,8,["icon"])])])],4)}}}),an={class:"row mb-2 items-center justify-center"},sn={class:"row mr-auto flex-1 gap-2 p-4"},ln={class:"row flex-1 justify-center"},rn={class:"rounded-md px-2 text-xl font-bold"},un=C("div",{class:"ml-auto flex-1"},null,-1),cn=W({setup(e){const t=Q(),o=S(()=>Mo(t.activeTimeblock.getDate()).format("LL"));function n(){t.isTaskDockOpen=!t.isTaskDockOpen}return(a,s)=>{const i=ee("v-icon"),r=ee("router-link");return T(),M("div",an,[C("div",sn,[B(r,{to:"/timeblocks"},{default:P(()=>[B(i,{icon:j(Nt),class:"cursor-pointer"},null,8,["icon"])]),_:1}),B(i,{icon:j(Pt),class:"cursor-pointer",onClick:n},null,8,["icon"])]),C("div",ln,[C("div",rn,Y(o.value),1)]),un])}}});function dn(e){switch(e){case"normal":return ae.color;case"fixed-weekly-time":return se.color;case"fixed-time":return ie.color;default:return"white"}}const mn={class:"task-box-editor m-2 self-stretch rounded-lg py-2 text-center"},kn=["value"],vn=["value"],gn=W({props:{name:null,description:null,taskType:null},emits:["update:name","update:description","blur"],setup(e,{emit:t}){const o=e;At(f=>({"14c7bc2d":n.value}));const n=S(()=>dn(o.taskType)),a=_(),s=_();let i=_(!1);async function r(f){i.value&&f.relatedTarget!==s.value&&(t("blur"),i.value=!1)}async function u(f){i.value&&f.relatedTarget!==a.value&&(t("blur"),i.value=!1)}function c(f){f.key==="Enter"&&s.value.focus()}function d(f){f.key==="Enter"&&s.value.blur()}return(f,v)=>(T(),M("div",mn,[C("input",{ref_key:"taskNameInputEl",ref:a,value:e.name,placeholder:"Task Name",type:"text",class:"w-full px-4 outline-none",onInput:v[0]||(v[0]=l=>t("update:name",l.target.value)),onFocusout:r,onKeydown:c,onFocus:v[1]||(v[1]=l=>i.value=!0)},null,40,kn),C("input",{ref_key:"taskDescriptionInputEl",ref:s,value:e.description,placeholder:"Task Description",type:"text",class:"w-full px-4 text-sm text-gray-500 outline-none",onInput:v[2]||(v[2]=l=>t("update:description",l.target.value)),onFocusout:u,onKeydown:d,onFocus:v[3]||(v[3]=l=>i.value=!0)},null,40,vn)]))}});var lt=Co(gn,[["__scopeId","data-v-55998f26"]]);const fn={class:"row items-center justify-between"},hn={class:"ml-4"},pn={class:"column mx-auto"},bn={class:"px-2 text-sm text-gray-500"},yn={class:"mr-4"},wn=W({props:{id:null},setup(e){const t=e,o=Q(),n=S(()=>o.activeTimeblock.getTask(t.id)),a=S(()=>({"background-color":n.value.getColor()}));function s(m){var p;(p=m.dataTransfer)==null||p.setData("text",JSON.stringify({type:le.taskBoxDrop,payload:{taskId:t.id}}))}let i=_(!1);function r(){i.value=!0}function u(){i.value=!1}async function c(){o.activeTimeblock.getTask(n.value.getId()).setIsHidden(!0),await q.mutation("hideTimeblockTask",{taskId:n.value.getId()})}let d=_(""),f=_(""),v=_(!1);function l(){var m;d.value=n.value.getName(),f.value=(m=n.value.getDescription())!=null?m:"",v.value=!0}async function g(){d.value!==""&&(v.value=!1,n.value.setName(d.value),n.value.setDescription(f.value),await q.mutation("updateTimeblockTask",{taskId:n.value.getId(),description:f.value,name:d.value}))}return(m,p)=>{const k=ee("v-icon");return v.value?(T(),Z(lt,{key:0,name:d.value,"onUpdate:name":p[0]||(p[0]=h=>d.value=h),description:f.value,"onUpdate:description":p[1]||(p[1]=h=>f.value=h),"task-type":n.value.getType(),onBlur:g},null,8,["name","description","task-type"])):(T(),M("div",{key:1,draggable:"true",class:"column m-2 cursor-grab self-stretch rounded-lg py-2 text-center active:cursor-grabbing",style:F(a.value),onDragstart:s,onMouseover:r,onMouseout:u},[C("div",fn,[te(C("div",hn,[B(k,{icon:j(zt),class:"cursor-pointer text-red-500 transition-all hover:scale-105",onClick:c},null,8,["icon"])],512),[[ge,i.value]]),C("div",pn,[C("div",null,Y(n.value.getName()),1),C("div",bn,Y(n.value.getDescription()),1)]),te(C("div",yn,[B(k,{icon:j(Ft),class:"cursor-pointer text-green-500 transition-all hover:scale-105",onClick:l},null,8,["icon"])],512),[[ge,i.value]])])],36))}}});var he=U({name:"QItemLabel",props:{overline:Boolean,caption:Boolean,header:Boolean,lines:[Number,String]},setup(e,{slots:t}){const o=E(()=>parseInt(e.lines,10)),n=E(()=>"q-item__label"+(e.overline===!0?" q-item__label--overline text-overline":"")+(e.caption===!0?" q-item__label--caption text-caption":"")+(e.header===!0?" q-item__label--header":"")+(o.value===1?" ellipsis":"")),a=E(()=>e.lines!==void 0&&o.value>1?{overflow:"hidden",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":o.value}:null);return()=>L("div",{style:a.value,class:n.value},oe(t.default))}}),rt=U({name:"QItemSection",props:{avatar:Boolean,thumbnail:Boolean,side:Boolean,top:Boolean,noWrap:Boolean},setup(e,{slots:t}){const o=E(()=>`q-item__section column q-item__section--${e.avatar===!0||e.side===!0||e.thumbnail===!0?"side":"main"}`+(e.top===!0?" q-item__section--top justify-start":" justify-center")+(e.avatar===!0?" q-item__section--avatar":"")+(e.thumbnail===!0?" q-item__section--thumbnail":"")+(e.noWrap===!0?" q-item__section--nowrap":""));return()=>L("div",{class:o.value},oe(t.default))}}),ut=U({name:"QItem",props:z($($({},Me),Vt),{tag:{type:String,default:"div"},active:Boolean,clickable:Boolean,dense:Boolean,insetLevel:Number,tabindex:[String,Number],focused:Boolean,manualFocus:Boolean}),emits:["click","keyup"],setup(e,{slots:t,emit:o}){const{proxy:{$q:n}}=de(),a=Ce(e,n),{hasRouterLink:s,hasLink:i,linkProps:r,linkClass:u,linkTag:c,navigateToRouterLink:d}=Kt(),f=V(null),v=V(null),l=E(()=>e.clickable===!0||i.value===!0||e.tag==="label"),g=E(()=>e.disable!==!0&&l.value===!0),m=E(()=>"q-item q-item-type row no-wrap"+(e.dense===!0?" q-item--dense":"")+(a.value===!0?" q-item--dark":"")+(i.value===!0?u.value:e.active===!0?`${e.activeClass!==void 0?` ${e.activeClass}`:""} q-item--active`:"")+(e.disable===!0?" disabled":"")+(g.value===!0?" q-item--clickable q-link cursor-pointer "+(e.manualFocus===!0?"q-manual-focusable":"q-focusable q-hoverable")+(e.focused===!0?" q-manual-focusable--focused":""):"")),p=E(()=>{if(e.insetLevel===void 0)return null;const w=n.lang.rtl===!0?"Right":"Left";return{["padding"+w]:16+e.insetLevel*56+"px"}});function k(w){g.value===!0&&(v.value!==null&&(w.qKeyEvent!==!0&&document.activeElement===f.value?v.value.focus():document.activeElement===v.value&&f.value.focus()),s.value===!0&&d(w),o("click",w))}function h(w){if(g.value===!0&&Ie(w,13)===!0){Ue(w),w.qKeyEvent=!0;const x=new MouseEvent("click",w);x.qKeyEvent=!0,f.value.dispatchEvent(x)}o("keyup",w)}function D(){const w=Qt(t.default,[]);return g.value===!0&&w.unshift(L("div",{class:"q-focus-helper",tabindex:-1,ref:v})),w}return()=>{const w={ref:f,class:m.value,style:p.value,onClick:k,onKeyup:h};return g.value===!0?(w.tabindex=e.tabindex||"0",Object.assign(w,r.value)):l.value===!0&&(w["aria-disabled"]="true"),L(c.value,w,D())}}}),Tn=U({name:"QList",props:z($({},Me),{bordered:Boolean,dense:Boolean,separator:Boolean,padding:Boolean}),setup(e,{slots:t}){const o=de(),n=Ce(e,o.proxy.$q),a=E(()=>"q-list"+(e.bordered===!0?" q-list--bordered":"")+(e.dense===!0?" q-list--dense":"")+(e.separator===!0?" q-list--separator":"")+(n.value===!0?" q-list--dark":"")+(e.padding===!0?" q-list--padding":""));return()=>L("div",{class:a.value},oe(t.default))}}),xn=U({name:"QBtnGroup",props:{unelevated:Boolean,outline:Boolean,flat:Boolean,rounded:Boolean,push:Boolean,stretch:Boolean,glossy:Boolean,spread:Boolean},setup(e,{slots:t}){const o=E(()=>{const n=["unelevated","outline","flat","rounded","push","stretch","glossy"].filter(a=>e[a]===!0).map(a=>`q-btn-group--${a}`).join(" ");return`q-btn-group row no-wrap${n.length>0?" "+n:""}`+(e.spread===!0?" q-btn-group--spread":" inline")});return()=>L("div",{class:o.value},oe(t.default))}});function _n(){if(window.getSelection!==void 0){const e=window.getSelection();e.empty!==void 0?e.empty():e.removeAllRanges!==void 0&&(e.removeAllRanges(),Yt.is.mobile!==!0&&e.addRange(document.createRange()))}else document.selection!==void 0&&document.selection.empty()}const Bn={target:{default:!0},noParentEvent:Boolean,contextMenu:Boolean};function Mn({showing:e,avoidEmit:t,configureAnchorEl:o}){const{props:n,proxy:a,emit:s}=de(),i=V(null);let r;function u(l){return i.value===null?!1:l===void 0||l.touches===void 0||l.touches.length<=1}const c={};o===void 0&&(Object.assign(c,{hide(l){a.hide(l)},toggle(l){a.toggle(l),l.qAnchorHandled=!0},toggleKey(l){Ie(l,13)===!0&&c.toggle(l)},contextClick(l){a.hide(l),Je(l),Ut(()=>{a.show(l),l.qAnchorHandled=!0})},prevent:Je,mobileTouch(l){if(c.mobileCleanup(l),u(l)!==!0)return;a.hide(l),i.value.classList.add("non-selectable");const g=l.target;Xe(c,"anchor",[[g,"touchmove","mobileCleanup","passive"],[g,"touchend","mobileCleanup","passive"],[g,"touchcancel","mobileCleanup","passive"],[i.value,"contextmenu","prevent","notPassive"]]),r=setTimeout(()=>{a.show(l),l.qAnchorHandled=!0},300)},mobileCleanup(l){i.value.classList.remove("non-selectable"),clearTimeout(r),e.value===!0&&l!==void 0&&_n()}}),o=function(l=n.contextMenu){if(n.noParentEvent===!0||i.value===null)return;let g;l===!0?a.$q.platform.is.mobile===!0?g=[[i.value,"touchstart","mobileTouch","passive"]]:g=[[i.value,"mousedown","hide","passive"],[i.value,"contextmenu","contextClick","notPassive"]]:g=[[i.value,"click","toggle","passive"],[i.value,"keyup","toggleKey","passive"]],Xe(c,"anchor",g)});function d(){Jt(c,"anchor")}function f(l){for(i.value=l;i.value.classList.contains("q-anchor--skip");)i.value=i.value.parentNode;o()}function v(){if(n.target===!1||n.target==="")i.value=null;else if(n.target===!0)f(a.$el.parentNode);else{let l=n.target;if(typeof n.target=="string")try{l=document.querySelector(n.target)}catch{l=void 0}l!=null?(i.value=l.$el||l,o()):(i.value=null,console.error(`Anchor: target "${n.target}" not found`))}}return K(()=>n.contextMenu,l=>{i.value!==null&&(d(),o(l))}),K(()=>n.target,()=>{i.value!==null&&d(),v()}),K(()=>n.noParentEvent,l=>{i.value!==null&&(l===!0?d():o())}),Ge(()=>{v(),t!==!0&&n.modelValue===!0&&i.value===null&&s("update:modelValue",!1)}),De(()=>{clearTimeout(r),d()}),{anchorEl:i,canShow:u,anchorEvents:c}}function Cn(e,t){const o=V(null);let n;function a(r,u){const c=`${u!==void 0?"add":"remove"}EventListener`,d=u!==void 0?u:n;r!==window&&r[c]("scroll",d,Se.passive),window[c]("scroll",d,Se.passive),n=u}function s(){o.value!==null&&(a(o.value),o.value=null)}const i=K(()=>e.noParentEvent,()=>{o.value!==null&&(s(),t())});return De(i),{localScrollTarget:o,unconfigureScrollTarget:s,changeScrollEvent:a}}let ct;const{notPassiveCapture:pe}=Se,J=[];function be(e){clearTimeout(ct);const t=e.target;if(t===void 0||t.nodeType===8||t.classList.contains("no-pointer-events")===!0)return;let o=Ze.length-1;for(;o>=0;){const n=Ze[o].$;if(n.type.name!=="QDialog")break;if(n.props.seamless!==!0)return;o--}for(let n=J.length-1;n>=0;n--){const a=J[n];if((a.anchorEl.value===null||a.anchorEl.value.contains(t)===!1)&&(t===document.body||a.innerRef.value!==null&&a.innerRef.value.contains(t)===!1))e.qClickOutside=!0,a.onClickOutside(e);else return}}function In(e){J.push(e),J.length===1&&(document.addEventListener("mousedown",be,pe),document.addEventListener("touchstart",be,pe))}function dt(e){const t=J.findIndex(o=>o===e);t>-1&&(J.splice(t,1),J.length===0&&(clearTimeout(ct),document.removeEventListener("mousedown",be,pe),document.removeEventListener("touchstart",be,pe)))}let mt,kt;function vt(e){const t=e.split(" ");return t.length!==2?!1:["top","center","bottom"].includes(t[0])!==!0?(console.error("Anchor/Self position must start with one of top/center/bottom"),!1):["left","middle","right","start","end"].includes(t[1])!==!0?(console.error("Anchor/Self position must end with one of left/middle/right/start/end"),!1):!0}function Dn(e){return e?!(e.length!==2||typeof e[0]!="number"||typeof e[1]!="number"):!0}const je={"start#ltr":"left","start#rtl":"right","end#ltr":"right","end#rtl":"left"};["left","middle","right"].forEach(e=>{je[`${e}#ltr`]=e,je[`${e}#rtl`]=e});function gt(e,t){const o=e.split(" ");return{vertical:o[0],horizontal:je[`${o[1]}#${t===!0?"rtl":"ltr"}`]}}function Sn(e,t){let{top:o,left:n,right:a,bottom:s,width:i,height:r}=e.getBoundingClientRect();return t!==void 0&&(o-=t[1],n-=t[0],s+=t[1],a+=t[0],i+=t[0],r+=t[1]),{top:o,left:n,right:a,bottom:s,width:i,height:r,middle:n+(a-n)/2,center:o+(s-o)/2}}function En(e){return{top:0,center:e.offsetHeight/2,bottom:e.offsetHeight,left:0,middle:e.offsetWidth/2,right:e.offsetWidth}}function $n(e){if(Xt.is.ios===!0&&window.visualViewport!==void 0){const r=document.body.style,{offsetLeft:u,offsetTop:c}=window.visualViewport;u!==mt&&(r.setProperty("--q-pe-left",u+"px"),mt=u),c!==kt&&(r.setProperty("--q-pe-top",c+"px"),kt=c)}let t;const{scrollLeft:o,scrollTop:n}=e.el;if(e.absoluteOffset===void 0)t=Sn(e.anchorEl,e.cover===!0?[0,0]:e.offset);else{const{top:r,left:u}=e.anchorEl.getBoundingClientRect(),c=r+e.absoluteOffset.top,d=u+e.absoluteOffset.left;t={top:c,left:d,width:1,height:1,right:d+1,center:c,middle:d,bottom:c+1}}let a={maxHeight:e.maxHeight,maxWidth:e.maxWidth,visibility:"visible"};(e.fit===!0||e.cover===!0)&&(a.minWidth=t.width+"px",e.cover===!0&&(a.minHeight=t.height+"px")),Object.assign(e.el.style,a);const s=En(e.el),i={top:t[e.anchorOrigin.vertical]-s[e.selfOrigin.vertical],left:t[e.anchorOrigin.horizontal]-s[e.selfOrigin.horizontal]};qn(i,t,s,e.anchorOrigin,e.selfOrigin),a={top:i.top+"px",left:i.left+"px"},i.maxHeight!==void 0&&(a.maxHeight=i.maxHeight+"px",t.height>i.maxHeight&&(a.minHeight=a.maxHeight)),i.maxWidth!==void 0&&(a.maxWidth=i.maxWidth+"px",t.width>i.maxWidth&&(a.minWidth=a.maxWidth)),Object.assign(e.el.style,a),e.el.scrollTop!==n&&(e.el.scrollTop=n),e.el.scrollLeft!==o&&(e.el.scrollLeft=o)}function qn(e,t,o,n,a){const s=o.bottom,i=o.right,r=Gt(),u=window.innerHeight-r,c=document.body.clientWidth;if(e.top<0||e.top+s>u)if(a.vertical==="center")e.top=t[n.vertical]>u/2?Math.max(0,u-s):0,e.maxHeight=Math.min(s,u);else if(t[n.vertical]>u/2){const d=Math.min(u,n.vertical==="center"?t.center:n.vertical===a.vertical?t.bottom:t.top);e.maxHeight=Math.min(s,d),e.top=Math.max(0,d-s)}else e.top=Math.max(0,n.vertical==="center"?t.center:n.vertical===a.vertical?t.top:t.bottom),e.maxHeight=Math.min(s,u-e.top);if(e.left<0||e.left+i>c)if(e.maxWidth=Math.min(i,c),a.horizontal==="middle")e.left=t[n.horizontal]>c/2?Math.max(0,c-i):0;else if(t[n.horizontal]>c/2){const d=Math.min(c,n.horizontal==="middle"?t.middle:n.horizontal===a.horizontal?t.right:t.left);e.maxWidth=Math.min(i,d),e.left=Math.max(0,d-e.maxWidth)}else e.left=Math.max(0,n.horizontal==="middle"?t.middle:n.horizontal===a.horizontal?t.left:t.right),e.maxWidth=Math.min(i,c-e.left)}var On=U({name:"QMenu",inheritAttrs:!1,props:z($($($($({},Bn),Zt),Me),eo),{persistent:Boolean,autoClose:Boolean,separateClosePopup:Boolean,noRouteDismiss:Boolean,noRefocus:Boolean,noFocus:Boolean,fit:Boolean,cover:Boolean,square:Boolean,anchor:{type:String,validator:vt},self:{type:String,validator:vt},offset:{type:Array,validator:Dn},scrollTarget:{default:void 0},touchPosition:Boolean,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null}}),emits:[...to,"click","escape-key"],setup(e,{slots:t,emit:o,attrs:n}){let a=null,s,i,r;const u=de(),{proxy:c}=u,{$q:d}=c,f=V(null),v=V(!1),l=E(()=>e.persistent!==!0&&e.noRouteDismiss!==!0),g=Ce(e,d),{registerTick:m,removeTick:p}=oo(),{registerTimeout:k,removeTimeout:h}=no(),{transition:D,transitionStyle:w}=ao(e,v),{localScrollTarget:x,changeScrollEvent:I,unconfigureScrollTarget:O}=Cn(e,Ve),{anchorEl:H,canShow:A}=Mn({showing:v}),{hide:R}=io({showing:v,canShow:A,handleShow:xt,handleHide:_t,hideOnRouteChange:l,processOnMount:!0}),{showPortal:N,hidePortal:pt,renderPortal:bt}=so(u,f,Mt),ye={anchorEl:H,innerRef:f,onClickOutside(b){if(e.persistent!==!0&&v.value===!0)return R(b),(b.type==="touchstart"||b.target.classList.contains("q-dialog__backdrop"))&&Ue(b),!0}},Ae=E(()=>gt(e.anchor||(e.cover===!0?"center middle":"bottom start"),d.lang.rtl)),yt=E(()=>e.cover===!0?Ae.value:gt(e.self||"top start",d.lang.rtl)),wt=E(()=>(e.square===!0?" q-menu--square":"")+(g.value===!0?" q-menu--dark q-dark":"")),Tt=E(()=>e.autoClose===!0?{onClick:Bt}:{}),ze=E(()=>v.value===!0&&e.persistent!==!0);K(ze,b=>{b===!0?(go(Te),In(ye)):(et(Te),dt(ye))});function we(){ko(()=>{let b=f.value;b&&b.contains(document.activeElement)!==!0&&(b=b.querySelector("[autofocus], [data-autofocus]")||b,b.focus({preventScroll:!0}))})}function xt(b){if(p(),h(),a=e.noRefocus===!1?document.activeElement:null,lo(Ke),N(),Ve(),s=void 0,b!==void 0&&(e.touchPosition||e.contextMenu)){const xe=ro(b);if(xe.left!==void 0){const{top:Ct,left:It}=H.value.getBoundingClientRect();s={left:xe.left-It,top:xe.top-Ct}}}i===void 0&&(i=K(()=>d.screen.width+"|"+d.screen.height+"|"+e.self+"|"+e.anchor+"|"+d.lang.rtl,re)),e.noFocus!==!0&&document.activeElement.blur(),m(()=>{re(),e.noFocus!==!0&&we()}),k(()=>{d.platform.is.ios===!0&&(r=e.autoClose,f.value.click()),re(),N(!0),o("show",b)},e.transitionDuration)}function _t(b){p(),h(),Fe(!0),a!==null&&(b===void 0||b.qClickOutside!==!0)&&(a.focus(),a=null),k(()=>{pt(),o("hide",b)},e.transitionDuration)}function Fe(b){s=void 0,i!==void 0&&(i(),i=void 0),(b===!0||v.value===!0)&&(uo(Ke),O(),dt(ye),et(Te)),b!==!0&&(a=null)}function Ve(){(H.value!==null||e.scrollTarget!==void 0)&&(x.value=co(H.value,e.scrollTarget),I(x.value,re))}function Bt(b){r!==!0?(vo(c,b),o("click",b)):r=!1}function Ke(b){ze.value===!0&&e.noFocus!==!0&&fo(f.value,b.target)!==!0&&we()}function Te(b){o("escape-key"),R(b)}function re(){const b=f.value;b===null||H.value===null||$n({el:b,offset:e.offset,anchorEl:H.value,anchorOrigin:Ae.value,selfOrigin:yt.value,absoluteOffset:s,fit:e.fit,cover:e.cover,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function Mt(){return L(mo,{name:D.value,appear:!0},()=>v.value===!0?L("div",$(z($({},n),{ref:f,tabindex:-1,class:["q-menu q-position-engine scroll"+wt.value,n.class],style:[n.style,w.value]}),Tt.value),oe(t.default)):null)}return De(Fe),Object.assign(c,{focus:we,updatePosition:re}),bt}}),Hn=U({name:"QBtnDropdown",props:z($({},ho),{modelValue:Boolean,split:Boolean,dropdownIcon:String,contentClass:[Array,String,Object],contentStyle:[Array,String,Object],cover:Boolean,persistent:Boolean,noRouteDismiss:Boolean,autoClose:Boolean,menuAnchor:{type:String,default:"bottom end"},menuSelf:{type:String,default:"top end"},menuOffset:Array,disableMainBtn:Boolean,disableDropdown:Boolean,noIconAnimation:Boolean}),emits:["update:modelValue","click","before-show","show","before-hide","hide"],setup(e,{slots:t,emit:o}){const{proxy:n}=de(),a=V(e.modelValue),s=V(null),i=E(()=>{const k={"aria-expanded":a.value===!0?"true":"false","aria-haspopup":"true"};return(e.disable===!0||e.split===!1&&e.disableMainBtn===!0||e.disableDropdown===!0)&&(k["aria-disabled"]="true"),k}),r=E(()=>"q-btn-dropdown__arrow"+(a.value===!0&&e.noIconAnimation===!1?" rotate-180":"")+(e.split===!1?" q-btn-dropdown__arrow-container":""));K(()=>e.modelValue,k=>{s.value!==null&&s.value[k?"show":"hide"]()}),K(()=>e.split,p);function u(k){a.value=!0,o("before-show",k)}function c(k){o("show",k),o("update:modelValue",!0)}function d(k){a.value=!1,o("before-hide",k)}function f(k){o("hide",k),o("update:modelValue",!1)}function v(k){o("click",k)}function l(k){bo(k),p(),o("click",k)}function g(k){s.value!==null&&s.value.toggle(k)}function m(k){s.value!==null&&s.value.show(k)}function p(k){s.value!==null&&s.value.hide(k)}return Object.assign(n,{show:m,hide:p,toggle:g}),Ge(()=>{e.modelValue===!0&&m()}),()=>{const k=[L(po,{class:r.value,name:e.dropdownIcon||n.$q.iconSet.arrow.dropdown})];return e.disableDropdown!==!0&&k.push(L(On,{ref:s,class:e.contentClass,style:e.contentStyle,cover:e.cover,fit:!0,persistent:e.persistent,noRouteDismiss:e.noRouteDismiss,autoClose:e.autoClose,anchor:e.menuAnchor,self:e.menuSelf,offset:e.menuOffset,separateClosePopup:!0,onBeforeShow:u,onShow:c,onBeforeHide:d,onHide:f},t.default)),e.split===!1?L(Ee,z($(z($({class:"q-btn-dropdown q-btn-dropdown--simple"},e),{disable:e.disable===!0||e.disableMainBtn===!0,noWrap:!0,round:!1}),i.value),{onClick:v}),()=>oe(t.label,[]).concat(k)):L(xn,{class:"q-btn-dropdown q-btn-dropdown--split no-wrap q-btn-item",outline:e.outline,flat:e.flat,rounded:e.rounded,push:e.push,unelevated:e.unelevated,glossy:e.glossy,stretch:e.stretch},()=>[L(Ee,z($({class:"q-btn-dropdown--current"},e),{disable:e.disable===!0||e.disableMainBtn===!0,noWrap:!0,iconRight:e.iconRight,round:!1,onClick:l}),t.label),L(Ee,z($({class:"q-btn-dropdown__arrow-container q-anchor--skip"},i.value),{disable:e.disable===!0||e.disableDropdown===!0,outline:e.outline,flat:e.flat,rounded:e.rounded,push:e.push,size:e.size,color:e.color,textColor:e.textColor,dense:e.dense,ripple:e.ripple}),()=>k)])}}});function ft(e){if(e===!1)return 0;if(e===!0||e===void 0)return 1;const t=parseInt(e,10);return isNaN(t)?0:t}var ht=yo({name:"close-popup",beforeMount(e,{value:t}){const o={depth:ft(t),handler(n){o.depth!==0&&setTimeout(()=>{const a=wo(e);a!==void 0&&To(a,n,o.depth)})},handlerKey(n){Ie(n,13)===!0&&o.handler(n)}};e.__qclosepopup=o,e.addEventListener("click",o.handler),e.addEventListener("keyup",o.handlerKey)},updated(e,{value:t,oldValue:o}){t!==o&&(e.__qclosepopup.depth=ft(t))},beforeUnmount(e){const t=e.__qclosepopup;e.removeEventListener("click",t.handler),e.removeEventListener("keyup",t.handlerKey),delete e.__qclosepopup}});const Ln=X("Add Fixed Time Task"),Rn=X(" A task that always occurs at the same time every day. "),jn=X("Add Fixed Weekly Time Task"),Wn=X(" A task that always occurs on the same time and day every week. "),Nn=W({emits:["select"],setup(e,{emit:t}){return(o,n)=>(T(),M("div",null,[B(Hn,{split:"","dropdown-icon":j(xo),color:"primary",label:"Add Task",class:"mb-2",onClick:n[2]||(n[2]=a=>t("select","normal"))},{default:P(()=>[B(Tn,null,{default:P(()=>[te((T(),Z(ut,{clickable:"",onClick:n[0]||(n[0]=a=>t("select","fixed-time"))},{default:P(()=>[B(rt,null,{default:P(()=>[B(he,null,{default:P(()=>[Ln]),_:1}),B(he,{caption:""},{default:P(()=>[Rn]),_:1})]),_:1})]),_:1})),[[ht]]),te((T(),Z(ut,{clickable:"",onClick:n[1]||(n[1]=a=>t("select","fixed-weekly-time"))},{default:P(()=>[B(rt,null,{default:P(()=>[B(he,null,{default:P(()=>[jn]),_:1}),B(he,{caption:""},{default:P(()=>[Wn]),_:1})]),_:1})]),_:1})),[[ht]])]),_:1})]),_:1},8,["dropdown-icon"])]))}}),Pn=["onDragover"],An={key:0,class:"column pointer-events-none absolute inset-0 top-[45px] mt-10 items-center rounded-md bg-[rgba(255,0,0,0.9)] pt-10"},zn=C("div",{class:"text-black"},"Delete Task Block",-1),Fn=C("div",{class:"mb-2 text-3xl font-bold"},"Tasks",-1),Vn=W({setup(e){const t=Q(),o=S(()=>t.activeTimeblock.getOrderedTaskIds().map(g=>t.activeTimeblock.getTask(g)).filter(g=>!g.getIsHidden())),n=_();let a=_(""),s=_(""),i=_(""),r=_(!1);async function u(g){r.value||(i.value=g,r.value=!0,a.value="",s.value="",await _o())}async function c(){if(a.value.trim()==="")a.value="",s.value="",r.value=!1;else{const g=ne();let m;switch(i.value){case"normal":{m=new ae({id:g,name:a.value,description:s.value,isHidden:!1});break}case"fixed-weekly-time":{m=new se({dayOfWeek:void 0,startMinute:void 0,endMinute:void 0,id:g,isHidden:!1,name:a.value,description:s.value});break}case"fixed-time":{m=new ie({endMinute:void 0,id:g,isHidden:!1,name:a.value,startMinute:void 0,description:s.value});break}default:throw new Error(`Unrecognized task type ${i.value}`)}t.activeTimeblock.addTask(m);const p=a.value,k=s.value;a.value="",s.value="",r.value=!1;try{await q.mutation("createTimeblockTask",{id:g,name:p,description:k,type:i.value})}catch(h){$e(h)}}}let d=_(!1);function f(){t.activeDraggingTaskBlock!==void 0&&(d.value=!0)}function v(){d.value=!1}async function l(g){var k,h,D;d.value=!1;const m=(h=(k=g.dataTransfer)==null?void 0:k.getData("text"))!=null?h:"";if(m==="")return;const p=JSON.parse(m);if(p.type===le.taskBoxDrop){const{payload:w}=p;if("sourceTaskBlockId"in w){const I=t.activeTimeblock.getTaskBlock(w.sourceTaskBlockId).getTimeblockColumnId();(D=t.activeTimeblock.getColumn(I))==null||D.removeTaskBlock(w.sourceTaskBlockId),await q.mutation("deleteTimeblockTaskBlock",{taskBlockId:w.sourceTaskBlockId,timeblockColumnId:I})}}}return(g,m)=>{const p=ee("v-icon");return te((T(),M("div",{class:"column relative w-[250px] shrink-0 items-center",onDrop:l,onDragover:ue(f,["prevent"]),onDragleave:v},[d.value?(T(),M("div",An,[B(p,{size:50,icon:j(Ye)},null,8,["icon"]),zn])):ve("",!0),Fn,B(Nn,{onSelect:u}),te(B(lt,{ref_key:"timeblockTaskBoxEditorEl",ref:n,name:a.value,"onUpdate:name":m[0]||(m[0]=k=>a.value=k),description:s.value,"onUpdate:description":m[1]||(m[1]=k=>s.value=k),"task-type":i.value,onBlur:c},null,8,["name","description","task-type"]),[[ge,r.value]]),(T(!0),M(G,null,ce(o.value,k=>(T(),Z(wn,{id:k.getId(),key:k.getId()},null,8,["id"]))),128))],40,Pn)),[[ge,j(t).isTaskDockOpen]])}}});class Kn{constructor({timeblock:t,id:o}){y(this,"timeblock");y(this,"id");y(this,"taskBlockIds");this.id=o,this.timeblock=t,this.taskBlockIds=new Set}getDate(){return this.timeblock.getDate()}getId(){return this.id}setTimeblock(t){this.timeblock=t}getTimeblock(){return this.timeblock}addTaskBlock(t){const o=this.timeblock.getTaskBlock(t);this.taskBlockIds.add(t),o.setTimeblockColumnId(this.getId())}removeTaskBlock(t){this.timeblock.getTaskBlock(t).setTimeblockColumnId(void 0),this.taskBlockIds.delete(t)}getTaskBlocks(){return[...this.taskBlockIds.values()].map(t=>this.timeblock.getTaskBlock(t))}}class Qn{constructor({id:t,date:o}){y(this,"id");y(this,"date");y(this,"columns");y(this,"taskMap");y(this,"taskBlockMap");y(this,"orderedTaskIds");y(this,"taskBlockToColumnNumberMap");this.id=t,this.date=o,this.taskMap=new Map,this.taskBlockMap=new Map,this.orderedTaskIds=[],this.columns=[]}getId(){return this.id}addTask(t,o=0){this.taskMap.set(t.getId(),t),this.orderedTaskIds.splice(o,0,t.getId())}removeTask(t){this.taskMap.delete(t)}getTask(t){const o=this.taskMap.get(t);if(o===void 0)throw new Error(`Task with ID ${t} not found.`);return o}getTaskBlock(t){const o=this.taskBlockMap.get(t);if(o===void 0)throw new Error(`Task block with ID ${t} not found.`);return o}addTaskBlock(t){this.taskBlockMap.set(t.getId(),t)}getOrderedTaskIds(){return this.orderedTaskIds}addColumn(t){this.columns.push(new Kn({timeblock:this,id:t}))}getColumn(t){return this.columns.find(o=>o.getId()===t)}deleteColumn(t){const o=this.columns.findIndex(n=>n.getId()===t);if(o===-1)throw new Error("Column not found.");this.columns.splice(o,1)}getDate(){return this.date}setDate(t){this.date=t}getColumns(){return this.columns}}const Yn={key:0},Un={key:1,class:"column"},Jn={class:"row px-4"},na=W({setup(e){const t=Bo(),o=S(()=>t.params),n=S(()=>o.value.id),a=Q();Be(()=>o.value.id,()=>{a.activeTimeblockId=o.value.id});let s=_(!0);return(async()=>{var c,d,f,v,l,g,m,p;const[i,r,u]=await Promise.all([q.query("getTimeblock",{timeblockId:o.value.id}),q.query("getTimeblockTasks",{limit:10,skip:0}),q.query("getTimeblockColumns",{timeblockId:o.value.id})]);if(!a.hasTimeblock(n.value)){const k=new Qn({id:n.value,date:i.date});for(const h of r){let D;switch(h.type){case"normal":{D=new ae({id:h.id,name:h.name,description:(c=h.description)!=null?c:"",isHidden:h.isHidden});break}case"fixed-time":{D=new ie({id:h.id,name:h.name,description:(d=h.description)!=null?d:"",isHidden:h.isHidden,startMinute:(f=h.startMinute)!=null?f:void 0,endMinute:(v=h.endMinute)!=null?v:void 0});break}case"fixed-weekly-time":{D=new se({id:h.id,name:h.name,description:(l=h.description)!=null?l:"",isHidden:h.isHidden,startMinute:(g=h.startMinute)!=null?g:void 0,endMinute:(m=h.endMinute)!=null?m:void 0,dayOfWeek:(p=h.dayOfWeek)!=null?p:void 0});break}default:throw new Error(`Unrecognized task type ${h.type}`)}k.addTask(D)}a.addTimeblock(k);for(const h of u)k.addColumn(h.id)}a.activeTimeblockId=n.value,s.value=!1})(),(i,r)=>s.value?(T(),M("div",Yn,[B(Io)])):(T(),M("div",Un,[B(cn),C("div",Jn,[B(Vn),B(nn)])]))}});export{na as default};
